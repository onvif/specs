<?xml version="1.0"?>
<?xml-stylesheet href="docbook.xsl" type="text/xsl" ?>
<book xmlns="http://docbook.org/ns/docbook" version="5.0">
  <info>
    <title>PTZ Service Specification</title>
    <titleabbrev>Ptz</titleabbrev>
    <releaseinfo>23.06</releaseinfo>
    <author>
      <orgname>ONVIF™</orgname>
      <uri>www.onvif.org</uri>
    </author>
    <pubdate>June, 2023</pubdate>
    <mediaobject>
      <imageobject>
        <imagedata fileref="media/logo.png" contentwidth="60mm" />
      </imageobject>
    </mediaobject>
    <copyright>
      <year>2008-2023</year>
      <holder>ONVIF™ All rights reserved.</holder>
    </copyright>
    <legalnotice>
      <para>Recipients of this document may copy, distribute, publish, or display this document so long as this copyright notice, license and disclaimer are retained with all copies of the document. No license is granted to modify this document.</para>
      <para>THIS DOCUMENT IS PROVIDED "AS IS," AND THE CORPORATION AND ITS MEMBERS AND THEIR AFFILIATES, MAKE NO REPRESENTATIONS OR WARRANTIES, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO, WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE, NON-INFRINGEMENT, OR TITLE; THAT THE CONTENTS OF THIS DOCUMENT ARE SUITABLE FOR ANY PURPOSE; OR THAT THE IMPLEMENTATION OF SUCH CONTENTS WILL NOT INFRINGE ANY PATENTS, COPYRIGHTS, TRADEMARKS OR OTHER RIGHTS.</para>
      <para>IN NO EVENT WILL THE CORPORATION OR ITS MEMBERS OR THEIR AFFILIATES BE LIABLE FOR ANY DIRECT, INDIRECT, SPECIAL, INCIDENTAL, PUNITIVE OR CONSEQUENTIAL DAMAGES, ARISING OUT OF OR RELATING TO ANY USE OR DISTRIBUTION OF THIS DOCUMENT, WHETHER OR NOT (1) THE CORPORATION, MEMBERS OR THEIR AFFILIATES HAVE BEEN ADVISED OF THE POSSIBILITY OF SUCH DAMAGES, OR (2) SUCH DAMAGES WERE REASONABLY FORESEEABLE, AND ARISING OUT OF OR RELATING TO ANY USE OR DISTRIBUTION OF THIS DOCUMENT.  THE FOREGOING DISCLAIMER AND LIMITATION ON LIABILITY DO NOT APPLY TO, INVALIDATE, OR LIMIT REPRESENTATIONS AND WARRANTIES MADE BY THE MEMBERS AND THEIR RESPECTIVE AFFILIATES TO THE CORPORATION AND OTHER MEMBERS IN CERTAIN WRITTEN POLICIES OF THE CORPORATION.</para>
    </legalnotice>
    <revhistory>
      <revision>
        <revnumber>2.1</revnumber>
        <date>Jul-2011</date>
        <author>
          <personname>Hans Busch</personname>
        </author>
        <revremark>Split from Core 2.0 without change of content.</revremark>
      </revision>
      <revision>
        <revnumber>2.1.1</revnumber>
        <date>Jan-2012</date>
        <author>
          <personname>Hans Busch</personname>
        </author>
        <revremark>Change Requests 262, 434, 535, 554</revremark>
      </revision>
      <revision>
        <revnumber>2.2</revnumber>
        <date>May-2012</date>
        <author>
          <personname>Takahiro Iwasaki</personname>
        </author>
        <revremark>Addition of Preset Tour and PT Control Direction features
Change Request 648</revremark>
      </revision>
      <revision>
        <revnumber>2.2.1</revnumber>
        <date>Sep-2012</date>
        <author>
          <personname>Hans Busch</personname>
        </author>
        <revremark>Change Request 708, 825</revremark>
      </revision>
      <revision>
        <revnumber>2.4</revnumber>
        <date>Mar-2013</date>
        <author>
          <personname>Daniel Fiala</personname>
        </author>
        <revremark>Change Request 871</revremark>
      </revision>
      <revision>
        <revnumber>2.4.1</revnumber>
        <date>Dec-2013</date>
        <author>
          <personname>Michio Hirai</personname>
        </author>
        <revremark>Change Request 1207, 1215</revremark>
      </revision>
      <revision>
        <revnumber>2.4.2</revnumber>
        <date>Jun-2014</date>
        <author>
          <personname>Michio Hirai</personname>
        </author>
        <revremark>Change Request 1360, 1361, 1362</revremark>
      </revision>
      <revision>
        <revnumber>2.5</revnumber>
        <date>Dec-2014</date>
        <author>
          <personname>Ottavio Campana, Michio Hirai</personname>
        </author>
        <revremark>Addition of Ramp feature
Change Request 1322</revremark>
      </revision>
      <revision>
        <revnumber>2.6</revnumber>
        <date>Jun-2015</date>
        <author>
          <personname>Michio Hirai</personname>
        </author>
        <revremark>Change Request 1660, 1668</revremark>
      </revision>
      <revision>
        <revnumber>2.6.1</revnumber>
        <date>Dec-2015</date>
        <author>
          <personname>Hiroyuki Sano</personname>
        </author>
        <revremark>Change Request 1700</revremark>
      </revision>
      <revision>
        <revnumber>16.12</revnumber>
        <date>Dec-2016</date>
        <author>
          <personname>Andrew Downs</personname>
        </author>
        <revremark>Incorporate PTZ spaces</revremark>
      </revision>
      <revision>
        <revnumber>17.06</revnumber>
        <date>Jun-2017</date>
        <author>
          <personname>Hans Busch</personname>
        </author>
        <author>
          <personname>Hiroyuki Sano</personname>
        </author>
        <author>
          <personname>Enrico Campana</personname>
        </author>
        <revremark>Update method layouts. Change Request 2044
Change Request 1843, 2001, 2030, 2031, 2035, 2043
Add GeoMove</revremark>
      </revision>
      <revision>
        <revnumber>17.12</revnumber>
        <date>Dec-2017</date>
        <author>
          <personname>Enrico Campana</personname>
        </author>
        <revremark>Add Annex B - GeoMove Positioning Space</revremark>
      </revision>
      <revision>
        <revnumber>18.12</revnumber>
        <date>Dec-2018</date>
        <author>
          <personname>Hiroyuki Sano</personname>
        </author>
        <revremark>Change Request 2362, 2379, 2380, 2381</revremark>
      </revision>
      <revision>
        <revnumber>20.12</revnumber>
        <date>Dec-2020</date>
        <author>
          <personname>Davide Cristanelli</personname>
        </author>
        <revremark>Add MoveAndStartTracking</revremark>
      </revision>
      <revision>
        <revnumber>23.06</revnumber>
        <date>Jun-2023</date>
        <author>
          <personname>Michael Adam</personname>
        </author>
        <revremark>Add clarification to PTZ spec regarding dynamic space ranges.</revremark>
      </revision>
    </revhistory>
  </info>
  <chapter>
    <title>Scope</title>
    <para>This document defines the web service interface for configuration and operation of pan tilt zoom controllers. Additionally the associated events are defined.</para>
    <para>Web service usage is outside of the scope of this document. Please refer to the ONVIF core specification.</para>
  </chapter>
  <chapter>
    <title>Normative references</title>
    <para>ONVIF Core Specification</para>
    <para role="reference">&lt;<link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://www.onvif.org/specs/core/ONVIF-Core-Specification.pdf"></link>&gt;</para>
    <para>ONVIF Media Service Specification</para>
    <para role="reference">&lt;<link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://www.onvif.org/specs/srv/media/ONVIF-Media-Service-Spec.pdf"></link>&gt;</para>
  </chapter>
  <chapter>
    <title>Terms and Definitions</title>
    <section>
      <title>Definitions</title>
      <informaltable>
        <tgroup cols="2">
          <colspec colname="c1" colwidth="24*" />
          <colspec colname="c2" colwidth="76*" />
          <tbody valign="top">
            <row>
              <entry align="left">
                <para>
                  <emphasis role="bold">Digital PTZ</emphasis>
                </para>
              </entry>
              <entry align="left">
                <para>Function that diminishes or crops an image to adjust the image position and ratio.</para>
              </entry>
            </row>
            <row>
              <entry align="left">
                <para>
                  <emphasis role="bold">Optical zoom</emphasis>
                </para>
              </entry>
              <entry align="left">
                <para>Changes the focal length (angle of view) for the device by moving the zoom lens in the camera’s optics.</para>
              </entry>
            </row>
            <row>
              <entry align="left">
                <para>
                  <emphasis role="bold">PTZ node</emphasis>
                </para>
              </entry>
              <entry align="left">
                <para>Low-level PTZ entity that maps to the PTZ device and its capabilities.</para>
              </entry>
            </row>
            <row>
              <entry align="left">
                <para>
                  <emphasis role="bold">Field of View</emphasis>
                </para>
              </entry>
              <entry align="left">
                <para>The part of the world that is visible through the camera at a particular position and orientation in space.</para>
              </entry>
            </row>
            <row>
              <entry align="left">
                <para>
                  <emphasis role="bold">Nadir</emphasis>
                </para>
              </entry>
              <entry align="left">
                <para>The direction below a dome camera that is mounted in the ceiling and looking downwards.</para>
              </entry>
            </row>
            <row>
              <entry align="left">
                <para>
                  <emphasis role="bold">E-flip</emphasis>
                </para>
              </entry>
              <entry align="left">
                <para>The behaviour when a PTZ Dome rotates the image and control directions as it passes the nadir during a tilt movement.</para>
              </entry>
            </row>
          </tbody>
        </tgroup>
      </informaltable>
    </section>
    <section>
      <title>Abbreviations</title>
      <informaltable>
        <tgroup cols="2">
          <colspec colname="c1" colwidth="24*" />
          <colspec colname="c2" colwidth="76*" />
          <tbody valign="top">
            <row>
              <entry valign="middle">
                <para>PTZ</para>
              </entry>
              <entry valign="middle">
                <para>Pan/tilt/zoom</para>
              </entry>
            </row>
            <row>
              <entry valign="middle">
                <para>E-Flip</para>
              </entry>
              <entry valign="middle">
                <para>Electrical flip</para>
              </entry>
            </row>
            <row>
              <entry valign="middle">
                <para>FOV</para>
              </entry>
              <entry valign="middle">
                <para>Field of View</para>
              </entry>
            </row>
          </tbody>
        </tgroup>
      </informaltable>
    </section>
  </chapter>
  <chapter xml:id="_Toc241999839">
    <title>Overview</title>
    <para>The PTZ model groups the possible movements of the PTZ unit into a pan/tilt component and into a Zoom component. To steer the PTZ unit, the service provides absolute move, relative move and continuous move operations. Different coordinate systems and units are used to feed these operations.</para>
    <para>The PTZ service provides an AbsoluteMove operation to move the PTZ device to an absolute position. The service expects the absolute position as an argument referencing an absolute coordinate system. The speed of the pan/tilt movement and the Zoom movement can be specified optionally. Speed values are positive scalars and do not contain any directional information. It is not possible to specify speeds for Pan and Tilt separately without knowledge about the current position. This approach to specifying a desired position generally produces a non-smooth and non-intuitive action.</para>
    <para>A RelativeMove operation is introduced by the PTZ service in order to steer the dome relative to the current position, but without the need to know the current position. The operation expects a positional translation as an argument referencing a relative coordinate system. This specification distinguishes between relative and absolute coordinate systems, since there are cases where no absolute coordinate system exists for a well-defined relative coordinate system. An optional speed argument can be added to the RelativeMove operation with the same meaning as for the AbsoluteMove operation.</para>
    <para>Finally, the PTZ device can be moved continuously via the ContinuousMove command in a certain direction with a certain speed. Thereby, a velocity vector represents both, the direction and the speed information. The latter is expressed by the length of the vector. </para>
    <para>The pan/tilt and Zoom coordinates can be uniquely specified by augmenting the coordinates with appropriate space URIs. A space URI uniquely represents the underlying coordinate system. Section <xref linkend="_Toc214944449" /> defines a standard set of coordinate systems. A PTZ node shall implement  these coordinate systems if the corresponding type of movement is supported by the PTZ node. In many cases, the pan/tilt position is represented by pan and tilt angles in a spherical coordinate system. A digital PTZ, operating on a fixed megapixel camera, may express the camera’s viewing direction by a pixel position on a static projection plane. Therefore, different coordinate systems are needed in this case in order to capture the physical or virtual movements of the PTZ device. Optionally, the PTZ node may define its own device specific coordinate systems to enable clients to take advantage of the specific properties of this PTZ node.</para>
    <para>The PTZ node description retrieved via the GetNode or GetNodes operation contains all coordinate systems supported by a specific PTZ node. Each coordinate system belongs to one of the following groups:</para>
    <itemizedlist>
      <listitem>
        <para>AbsolutePanTiltPositionSpace</para>
      </listitem>
      <listitem>
        <para>RelativePanTiltTranslationSpace</para>
      </listitem>
      <listitem>
        <para>ContinuousPanTiltVelocitySpace</para>
      </listitem>
      <listitem>
        <para>PanTiltSpeedSpace</para>
      </listitem>
      <listitem>
        <para>AbsoluteZoomPositionSpace</para>
      </listitem>
      <listitem>
        <para>RelativeZoomTranslationSpace</para>
      </listitem>
      <listitem>
        <para>ContinuousZoomVelocitySpace</para>
      </listitem>
      <listitem>
        <para>ZoomSpeedSpace</para>
      </listitem>
    </itemizedlist>
    <para>If the PTZ node does not support the coordinate systems of a certain group, the corresponding move operation will not be available for this PTZ node. For instance, if the list does not contain an AbsolutePanTiltPositionSpace, the AbsoluteMove operation shall fail when an absolute pan/tilt position is specified. The corresponding command section describes those spaces that are required for a specific move command.</para>
    <para>WSDL for this service is specified in <link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://www.onvif.org/onvif/ver20/ptz/wsdl/ptz.wsdl">http://www.onvif.org/onvif/ver20/ptz/wsdl/ptz.wsdl</link>.</para>
    <table>
      <title>Referenced namespaces (with prefix)</title>
      <tgroup cols="2">
        <colspec colname="c1" colwidth="13*" />
        <colspec colname="c2" colwidth="87*" />
        <thead>
          <row>
            <entry>
              <para>Prefix</para>
            </entry>
            <entry>
              <para>Namespace URI</para>
            </entry>
          </row>
        </thead>
        <tbody valign="top">
          <row>
            <entry>
              <para>env</para>
            </entry>
            <entry>
              <para>http://www.w3.org/2003/05/soap-envelope</para>
            </entry>
          </row>
          <row>
            <entry>
              <para>ter</para>
            </entry>
            <entry>
              <para>http://www.onvif.org/ver10/error</para>
            </entry>
          </row>
          <row>
            <entry>
              <para>xs </para>
            </entry>
            <entry>
              <para>http://www.w3.org/2001/XMLSchema </para>
            </entry>
          </row>
          <row>
            <entry>
              <para>tt</para>
            </entry>
            <entry>
              <para>http://www.onvif.org/ver10/schema</para>
            </entry>
          </row>
          <row>
            <entry>
              <para>tptz</para>
            </entry>
            <entry>
              <para>http://www.onvif.org/ver20/ptz/wsdl</para>
            </entry>
          </row>
        </tbody>
      </tgroup>
    </table>
  </chapter>
  <chapter>
    <title>Service</title>
    <section>
      <title>PTZ Node</title>
      <section>
        <title>General</title>
        <para>A PTZ-capable device can have multiple PTZ nodes. The PTZ nodes can represent mechanical PTZ drivers, uploaded PTZ drivers or digital PTZ drivers. PTZ nodes are the lowest level entities in the PTZ control API and reflect the supported PTZ capabilities. The PTZ node is referenced either by its name or by its reference token. The PTZ Service does not provide operations to create or manipulate PTZ nodes.</para>
        <para>The following properties shall be provided for all PTZ nodes:</para>
        <itemizedlist>
          <listitem>
            <para>Token – A unique identifier used to reference PTZ nodes.</para>
          </listitem>
          <listitem>
            <para>Name – A name given by the installer.</para>
          </listitem>
          <listitem>
            <para>SupportedPTZSpaces – A list of coordinate systems available for the PTZ node. For each Coordinate System, the PTZ node shall specify its allowed range.</para>
          </listitem>
          <listitem>
            <para>MaximumNumberOfPresets – All preset operations shall be available for this PTZ node if one preset is supported.</para>
          </listitem>
          <listitem>
            <para>HomeSupported – A boolean operator specifying the availability of a home position. If set to true, the Home Position operations shall be available for this PTZ node.</para>
          </listitem>
          <listitem>
            <para>AuxiliaryCommands – A list of supported Auxiliary commands. If the list is not empty, the Auxiliary Operations shall be available for this PTZ node. A device may use auxiliary commands that are described in Core Specification.</para>
          </listitem>
          <listitem>
            <para>MaximumNumberOfPresetTours – Indicates number of preset tours that can be created. Required preset tour operations shall be available for this PTZ node if one or more preset tours are supported.</para>
          </listitem>
        </itemizedlist>
      </section>
      <section>
        <title>GetNodes</title>
        <para>A PTZ-capable device shall implement this operation and return all PTZ nodes available on the device.</para>
        <variablelist role="op">
          <varlistentry>
            <term>request</term>
            <listitem>
              <para role="text">This is an empty message.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>response</term>
            <listitem>
              <para role="param">PTZNode - optional, unbounded [tt:PTZNode]</para>
              <para role="text">List of the existing PTZ nodes on the device.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>faults</term>
            <listitem>
              <para role="text">None</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>access class</term>
            <listitem>
              <para role="access">READ_MEDIA</para>
            </listitem>
          </varlistentry>
        </variablelist>
      </section>
      <section>
        <title>GetNode</title>
        <para>A PTZ-capable device shall implement the GetNode operation and return the properties of the requested PTZ node, if it exists. Otherwise, the device shall respond with an appropriate fault message.</para>
        <variablelist role="op">
          <varlistentry>
            <term>request</term>
            <listitem>
              <para role="param">NodeToken [tt:ReferenceToken]</para>
              <para role="text">Reference to the requested PTZ node.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>response</term>
            <listitem>
              <para role="param">PTZNode [tt:PTZNode]</para>
              <para role="text">The requested PTZ node properties.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>faults</term>
            <listitem>
              <para role="param">env:Sender - ter:InvalidArgVal - ter:NoEntity</para>
              <para role="text">No such PTZ node on the device.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>access class</term>
            <listitem>
              <para role="access">READ_MEDIA</para>
            </listitem>
          </varlistentry>
        </variablelist>
      </section>
    </section>
    <section>
      <title>PTZ Configuration</title>
      <section>
        <title>General</title>
        <para>The PTZConfiguration contains a reference to the PTZ node in which it belongs. This reference cannot be changed by a client.</para>
        <para>The following elements are part of the PTZ Configuration:</para>
        <itemizedlist>
          <listitem>
            <para>PTZNodeToken – A mandatory reference to the PTZ node that the PTZ configuration belongs to. </para>
          </listitem>
          <listitem>
            <para>DefaultAbsolutePanTiltPositionSpace – If the PTZ node supports absolute pan/tilt movements, it shall specify one absolute pan/tilt position space as default. </para>
          </listitem>
          <listitem>
            <para>DefaultRelativePanTiltTranslationSpace – If the PTZ node supports relative pan/tilt movements, it shall specify one relative pan/tilt translation space as default.</para>
          </listitem>
          <listitem>
            <para>DefaultContinuousPanTiltVelocitySpace – If the PTZ node supports continuous pan/tilt movements, it shall specify one continuous pan/tilt velocity space as default.</para>
          </listitem>
          <listitem>
            <para>DefaultPanTiltSpeedSpace – If the PTZ node supports absolute or relative movements, it shall specify one pan/tilt speed space as default.</para>
          </listitem>
          <listitem>
            <para>DefaultAbsoluteZoomPositionSpace – If the PTZ node supports absolute zoom movements, it shall specify one absolute zoom position space as default.</para>
          </listitem>
          <listitem>
            <para>DefaultRelativeZoomTranslationSpace – If the PTZ node supports relative zoom movements, it shall specify one relative zoom translation space as default.</para>
          </listitem>
          <listitem>
            <para>DefaultContinuousZoomVelocitySpace – If the PTZ node supports continuous zoom movements, it shall specify one continuous zoom velocity space as default.</para>
          </listitem>
          <listitem>
            <para>DefaultPTZSpeed – If the PTZ node supports absolute or relative PTZ movements, it shall specify corresponding default pan/tilt and zoom speeds.</para>
          </listitem>
          <listitem>
            <para>DefaultPTZTimeout – If the PTZ node supports continuous movements, it shall specify a default timeout, after which the movement stops. </para>
          </listitem>
          <listitem>
            <para>PanTiltLimits – The pan/tilt limits element should be present for a PTZ node that supports an absolute pan/tilt. If the element is present it signals the support for configurable pan/tilt limits. If limits are enabled, the pan/tilt movements shall always stay within the specified range. The pan/tilt limits are disabled by setting the limits to –INF or +INF. </para>
          </listitem>
          <listitem>
            <para>ZoomLimits – The zoom limits element should be present for a PTZ node that supports absolute zoom. If the element is present it signals the supports for configurable zoom limits. If limits are enabled the zoom movements shall always stay within the specified range. The zoom limits are disabled by settings the limits to –INF and +INF. </para>
          </listitem>
          <listitem>
            <para>MoveRamp – The optional acceleration ramp used by the device when moving.</para>
          </listitem>
          <listitem>
            <para>PresetRamp – The optional acceleration ramp used by the device when recalling presets.</para>
          </listitem>
          <listitem>
            <para>PresetTourRamp – The optional acceleration ramp used by the device when executing PresetTours.</para>
          </listitem>
        </itemizedlist>
        <para>The default position/translation/velocity spaces are introduced to allow clients sending move requests without the need to specify a certain coordinate system. The default speeds are introduced to control the speed of move requests (absolute, relative, preset), where no explicit speed has been set.</para>
        <para>The allowed pan and tilt range for pan/tilt limits are defined by a two-dimensional space range that is mapped to a specific absolute pan/tilt position space. At least one pan/tilt position space is required by the PTZNode to support pan/tilt limits. The limits apply to all supported absolute, relative and continuous pan/tilt movements. The limits shall be checked within the coordinate system for which the limits have been specified. What this means in practice is that even if movements are specified in a different coordinate system, the requested movements shall be transformed to the coordinate system of the limits where the limits can be checked. When a relative or continuous movements is specified, which would leave the specified limits, the PTZ unit has to move along the specified limits. The zoom limits have to be interpreted accordingly.</para>
      </section>
      <section>
        <title>GetConfigurations</title>
        <para>A PTZ-capable device shall return all available PTZConfigurations through the GetConfigurations operation.</para>
        <variablelist role="op">
          <varlistentry>
            <term>request</term>
            <listitem>
              <para role="text">This is an empty message.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>response</term>
            <listitem>
              <para role="param">PTZConfiguration - optional, unbounded [tt:PTZConfiguration]</para>
              <para role="text">List of all existing PTZConfigurations on the device.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>faults</term>
            <listitem>
              <para role="text">None</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>access class</term>
            <listitem>
              <para role="access">READ_MEDIA</para>
            </listitem>
          </varlistentry>
        </variablelist>
      </section>
      <section>
        <title>GetConfiguration</title>
        <para>A PTZ-capable device shall return the requested PTZ configuration, if it exists, through the GetConfiguration operation.</para>
        <variablelist role="op">
          <varlistentry>
            <term>request</term>
            <listitem>
              <para role="param">ConfigurationToken [tt:ReferenceToken]</para>
              <para role="text">Reference to the requested PTZ configuration.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>response</term>
            <listitem>
              <para role="param">PTZConfiguration[tt:PTZConfiguration]</para>
              <para role="text">The requested PTZ node configuration.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>faults</term>
            <listitem>
              <para role="param">env:Sender - ter:InvalidArgVal - ter:NoConfig</para>
              <para role="text">The requested configuration does not exist.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>access class</term>
            <listitem>
              <para role="access">READ_MEDIA</para>
            </listitem>
          </varlistentry>
        </variablelist>
      </section>
      <section>
        <title>GetConfigurationOptions</title>
        <para>A PTZ-capable device shall implement the GetConfigurationOptions operation. It returns the list of supported coordinate systems including their range limitations. Therefore, the options MAY differ depending on whether the PTZ configuration is assigned to a profile(see ONVIF Media Service Specification) containing a VideoSourceConfiguration. In this case, the options may contain additional coordinate systems referring to the image coordinate system described by the VideoSourceConfiguration. Each listed coordinate system belongs to one of the groups listed in Section <xref linkend="_Toc241999839" />. If the PTZ node supports continuous movements, it shall return a timeout range within which timeouts are accepted by the PTZ node.</para>
        <variablelist role="op">
          <varlistentry>
            <term>request</term>
            <listitem>
              <para role="param">ConfigurationToken [tt:ReferenceToken]</para>
              <para role="text">Reference to the requested PTZ configuration.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>response</term>
            <listitem>
              <para role="param">PTZConfigurationOptions[tt:PTZConfigurationOptions]</para>
              <para role="text">The requested PTZ node configuration options.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>faults</term>
            <listitem>
              <para role="param">env:Sender - ter:InvalidArgVal - ter:NoConfig</para>
              <para role="text">The requested configuration does not exist.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>access class</term>
            <listitem>
              <para role="access">READ_MEDIA</para>
            </listitem>
          </varlistentry>
        </variablelist>
      </section>
      <section>
        <title>SetConfiguration</title>
        <para>A PTZ-capable device shall implement the SetConfiguration operation. The ForcePersistence flag indicates if the changes remain after reboot of the device.</para>
        <variablelist role="op">
          <varlistentry>
            <term>request</term>
            <listitem>
              <para role="param">ConfigurationToken [tt:ReferenceToken]</para>
              <para role="text">Reference to the PTZ configuration to be modified.</para>
              <para role="param">PTZConfigurationOptions[tt:PTZConfigurationOptions]</para>
              <para role="text">The requested PTZ node configuration options.</para>
              <para role="param">ForcePersistence [xs:boolean]</para>
              <para role="text">Deprecated modifier for temporary settings if supported by the device.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>response</term>
            <listitem>
              <para role="text">This is an empty message.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>faults</term>
            <listitem>
              <para role="param">env:Sender - ter:InvalidArgVal - ter:NoConfig</para>
              <para role="text">The requested configuration does not exist.</para>
              <para role="param">env:Sender - ter:InvalidArgVal - ter:ConfigModify</para>
              <para role="text">The configuration parameters cannot be set.</para>
              <para role="param">env:Receiver - ter:Action - ter:ConfigurationConflict</para>
              <para role="text">The new settings conflict with other uses of the configuration.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>access class</term>
            <listitem>
              <para role="access">ACTUATE</para>
            </listitem>
          </varlistentry>
        </variablelist>
      </section>
      <section>
        <title>GetCompatibleConfigurations</title>
        <para>A device signalling support for GetCompatibleConfigurations via the capability GetCompatibleConfigurations shall return all available PTZConfigurations that can be added to the referenced media profile through the GetComatibleConfigurations operation.</para>
        <para>A device providing more than one PTZConfiguration or more than one VideoSourceConfiguration or which has any other resource interdependency between PTZConfiguration entities and other resources listable in a media profile should implement this operation. PTZConfiguration entities returned by this operation shall not fail on adding them to the referenced media profile.</para>
        <variablelist role="op">
          <varlistentry>
            <term>request</term>
            <listitem>
              <para role="param">ProfileToken [tt:ReferenceToken]</para>
              <para role="text">Token of an existing media profile.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>response</term>
            <listitem>
              <para role="param">PTZConfiguration - optional, unbounded [tt:PTZConfiguration]</para>
              <para role="text">List of compatible PTZ node configurations.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>faults</term>
            <listitem>
              <para role="param">env:Receiver - ter:ActionNotSupported - ter:OptionalActionNotSupported</para>
              <para role="text">This method is not implemented by the device.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>access class</term>
            <listitem>
              <para role="access">READ_MEDIA</para>
            </listitem>
          </varlistentry>
        </variablelist>
      </section>
    </section>
    <section>
      <title>Move Operations</title>
      <para>This section describes three operations to move the PTZ unit absolutely, relatively or continuously. All operations require a profile token referencing a Media Profile that includes a PTZConfiguration.</para>
      <para>All move commands shall be implemented non-blocking, meaning they shall not wait until the requested move operation has finished. The last move operation can be overwritten by sending another move request.</para>
      <para>Due to the wide range of physical devices this specification addressescovers, the specification does not require a specific response time to PTZ move operations is not required. However, a device shall strive for minimal latency regarding PTZ move command request-to-response time. Note that the device does not have full control of the lag from PTZ control input and device movement. Network delays and client delays can further increase lag. Implementations should minimize device lag as much as possible.</para>
      <section>
        <title>AbsoluteMove </title>
        <para>If a PTZ node supports absolute pan/tilt or absolute zoom movements, it shall support the AbsoluteMove operation. The position argument of this command specifies the absolute position to which the PTZ unit moves. It splits into an optional pan/tilt element and an optional zoom element. If the pan/tilt position is omitted, the current pan/tilt movement shall not be affected by this command. The same holds for the zoom position. </para>
        <para>The spaces referenced within the position shall be absolute position spaces supported by the PTZ node. If the space information is omitted, the corresponding default spaces of the PTZ configuration, a part of the specified media profile, is used. A device may support absolute pan/tilt movements, absolute zoom movements or no absolute movements by providing only absolute position spaces for the supported cases.</para>
        <para>An existing Speed argument overrides DefaultSpeed of the corresponding PTZ configuration during movement to the requested position. If spaces are referenced within the Speed argument, they shall be speed spaces supported by the PTZ node.</para>
        <para>The operation shall fail if the requested absolute position is not reachable.</para>
        <variablelist role="op">
          <varlistentry>
            <term>request</term>
            <listitem>
              <para role="param">ProfileToken [tt:ReferenceToken]</para>
              <para role="text">Reference to an existing media profile.</para>
              <para role="param">Position [tt:PTZVector]</para>
              <para role="text">Vector specifying the absolute target position.</para>
              <para role="param">Speed - optional [tt:PTZSpeed]</para>
              <para role="text">Optional speed vector.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>response</term>
            <listitem>
              <para role="text">This is an empty message.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>faults</term>
            <listitem>
              <para role="param">env:Sender - ter:InvalidArgVal - ter:NoProfile</para>
              <para role="text">The requested profile token ProfileToken does not exist.</para>
              <para role="param">env:Sender - ter:InvalidArgVal - ter:NoPTZProfile</para>
              <para role="text">The requested profile token does not reference a PTZ configuration.</para>
              <para role="param">env:Sender - ter:InvalidArgVal - ter:SpaceNotSupported</para>
              <para role="text">A space is referenced that is not supported by the PTZ node.</para>
              <para role="param">env:Sender - ter:InvalidArgVal - ter:InvalidPosition</para>
              <para role="text">The requested position is out of bounds.</para>
              <para role="param">env:Sender - ter:InvalidArgVal - ter:InvalidSpeed</para>
              <para role="text">The requested speed is out of bounds.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>access class</term>
            <listitem>
              <para role="access">ACTUATE</para>
            </listitem>
          </varlistentry>
        </variablelist>
      </section>
      <section>
        <title>RelativeMove</title>
        <para>If a PTZ node supports relative pan/tilt or relative zoom movements, then it shall support the RelativeMove operation. The translation argument of this operation specifies the difference from the current position to the position to which the PTZ device is instructed to move. The operation is split into an optional pan/tilt element and an optional zoom element. If the pan/tilt element is omitted, the current pan/tilt movement shall NOT be affected by this command. The same holds for the zoom element. </para>
        <para>The spaces referenced within the translation element shall be translation spaces supported by the PTZ node. If the space information is omitted for the translation argument, the corresponding default spaces of the PTZ configuration, which is part of the specified media profile, is used. A device may support relative pan/tilt movements, relative Zoom movements or no relative movements by providing only translation spaces for the supported cases.</para>
        <para>An existing speed argument overrides DefaultSpeed of the corresponding PTZ configuration during movement by the requested translation. If spaces are referenced within the speed argument, they shall be speed spaces supported by the PTZ node.</para>
        <para>The command can be used to stop the PTZ unit at its current position by sending zero values for pan/tilt and zoom. Stopping shall have the very same effect independent of the relative space referenced.</para>
        <para>If the requested translation leads to an absolute position which cannot be reached, the PTZ node shall move to a reachable position along the border of valid positions.</para>
        <variablelist role="op">
          <varlistentry>
            <term>request</term>
            <listitem>
              <para role="param">ProfileToken [tt:ReferenceToken]</para>
              <para role="text">Reference to an existing media profile.</para>
              <para role="param">Translation [tt:PTZVector]</para>
              <para role="text">Vector specifying the positional translation relative to the current position.</para>
              <para role="param">Speed - optional [tt:PTZSpeed]</para>
              <para role="text">Optional speed vector.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>response</term>
            <listitem>
              <para role="text">This is an empty message.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>faults</term>
            <listitem>
              <para role="param">env:Sender - ter:InvalidArgVal - ter:NoProfile</para>
              <para role="text">The requested profile token does not exist.</para>
              <para role="param">env:Sender - ter:InvalidArgVal - ter:NoPTZProfile</para>
              <para role="text">The requested profile token does not reference a PTZ configuration.</para>
              <para role="param">env:Sender - ter:InvalidArgVal - ter:SpaceNotSupported</para>
              <para role="text">A space is referenced which is not supported by the PTZ node.</para>
              <para role="param">env:Sender - ter:InvalidArgVal - ter:<phrase>InvalidTranslation</phrase></para>
              <para role="text">The requested translation is out of bounds.</para>
              <para role="param">env:Sender - ter:InvalidArgVal - ter:InvalidSpeed</para>
              <para role="text">The requested speed is out of bounds.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>access class</term>
            <listitem>
              <para role="access">ACTUATE</para>
            </listitem>
          </varlistentry>
        </variablelist>
      </section>
      <section>
        <title>ContinuousMove</title>
        <para>A PTZ-capable device shall support continuous movements. The velocity argument of this command specifies a signed speed value for the pan, tilt and zoom. The combined pan/tilt element is optional and the Zoom element itself is optional. If the pan/tilt element is omitted, the current pan/tilt movement shall not be affected by this command. The same holds for the zoom element. The spaces referenced within the velocity element shall be velocity spaces supported by the PTZ node. If the space information is omitted for the velocity argument, the corresponding default spaces of the PTZ configuration belonging to the specified media profile is used. A device may support continuous pan/tilt movements and/or continuous zoom movements by providing only velocity spaces for the supported cases.</para>
        <para>An existing timeout argument overrides the DefaultPTZTimeout parameter of the corresponding PTZ configuration for this Move operation. The timeout parameter specifies how long the PTZ node continues to move.</para>
        <para>A device shall stop movement in a particular axis (Pan, Tilt, or Zoom) when zero is sent as the ContinuousMove parameter for that axis.　Stopping shall have the same effect independent of the velocity space referenced. This command has the same effect on a continuous move as the stop command specified in section <xref linkend="_Ref485888623" />.</para>
        <para>If the requested velocity leads to absolute positions which cannot be reached, the PTZ node shall move to a reachable position along the border of its range. A typical application of the continuous move operation is controlling PTZ via joystick.</para>
        <variablelist role="op">
          <varlistentry>
            <term>request</term>
            <listitem>
              <para role="param">ProfileToken [tt:ReferenceToken]</para>
              <para role="text">Reference to an existing media profile.</para>
              <para role="param">Velocity [tt:PTZSpeed]</para>
              <para role="text">Speed vector specifying the velocity of pan, tilt and zoom.</para>
              <para role="param">Timeout - optional [xs:duration]</para>
              <para role="text">Optional timeout.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>response</term>
            <listitem>
              <para role="text">This is an empty message.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>faults</term>
            <listitem>
              <para role="param">env:Sender - ter:InvalidArgVal - ter:NoProfile</para>
              <para role="text">The requested profile token ProfileToken does not exist.</para>
              <para role="param">env:Sender - ter:InvalidArgVal - ter:NoPTZProfile</para>
              <para role="text">The requested profile token does not reference a PTZ configuration.</para>
              <para role="param">env:Sender - ter:InvalidArgVal - ter:SpaceNotSupported</para>
              <para role="text">A space is referenced which is not supported by the PTZ node.</para>
              <para role="param">env:Sender - ter:InvalidArgVal - ter:<phrase>InvalidTranslation</phrase></para>
              <para role="text">The requested translation is out of bounds.</para>
              <para role="param">env:Sender - ter:InvalidArgVal - ter:<phrase>TimeoutNotSupported</phrase></para>
              <para role="text">The specified timeout argument is not within the supported timeout range.</para>
              <para role="param">env:Sender - ter:InvalidArgVal - ter:InvalidVelocity</para>
              <para role="text">The requested speed is out of bounds.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>access class</term>
            <listitem>
              <para role="access">ACTUATE</para>
            </listitem>
          </varlistentry>
        </variablelist>
      </section>
      <section>
        <title>GeoMove</title>
        <para>A device signaling GeoMove in one of its PTZ nodes shall support this command.</para>
        <para>The optional AreaHeight and AreaWidth parameters can be added to the request, so that the PTZ-capable device can internally determine the zoom factor. In case both AreaHeight and AreaWidth are not provided, the unit will not change the zoom. AreaHeight and AreaWidth are expressed in meters.</para>
        <para>An existing speed argument overrides the DefaultSpeed of the corresponding PTZ configuration during movement by the requested translation. If spaces are referenced within the speed argument, they shall be speed spaces supported by the PTZ node.</para>
        <para>If the PTZ-capable device does not support automatic retrieval of the geolocation, it shall be configured by using SetGeoLocation before it can perform geo-referenced commands. If the client requests a GeoMove command before the geolocation of the device is configured, the device shall return an error.</para>
        <para>Depending on the kinematics of the PTZ-capable device, the requested position may not be reachable. In this situation the device shall return an error, signalling that it cannot perform the requested action due to physical limitations.</para>
        <variablelist role="op">
          <varlistentry>
            <term>request</term>
            <listitem>
              <para role="param">ProfileToken [tt:ReferenceToken]</para>
              <para role="text">Reference to an existing media profile.</para>
              <para role="param">Target [tt:GeoLocation]</para>
              <para role="text">Target coordinates.</para>
              <para role="param">Speed - optional [tt:PTZSpeed]</para>
              <para role="text">Speed vector specifying the velocity of pan, tilt and zoom.</para>
              <para role="param">AreaWidth - optional [xs:float]</para>
              <para role="text">Optional area to be shown.</para>
              <para role="param">AreaHeight - optional [xs:float]</para>
              <para role="text">Optional area to be shown.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>response</term>
            <listitem>
              <para role="text">This is an empty message.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>faults</term>
            <listitem>
              <para role="param">env:Sender - ter:InvalidArgVal - ter:NoProfile</para>
              <para role="text">The requested profile token ProfileToken does not exist.</para>
              <para role="param">env:Sender - ter:InvalidArgVal - ter:NoPTZProfile</para>
              <para role="text">The requested profile token does not reference a PTZ configuration.</para>
              <para role="param">env:Sender - ter:InvalidArgVal - ter:GeoMoveNotSupported</para>
              <para role="text">The device does not support geo move.</para>
              <para role="param">env:Sender - ter:InvalidArgVal - ter:<phrase>UnreachablePosition</phrase></para>
              <para role="text">The requested translation is out of bounds.</para>
              <para role="param">env:Sender - ter:InvalidArgVal - ter:<phrase>TimeoutNotSupported</phrase></para>
              <para role="text">The requested position is not reachable.</para>
              <para role="param">env:Sender - ter:InvalidArgVal - ter:GeoLocationUnknown</para>
              <para role="text">The unit is not able to perform GeoMove because its geolocation is not configured or available.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>access class</term>
            <listitem>
              <para role="access">ACTUATE</para>
            </listitem>
          </varlistentry>
        </variablelist>
      </section>
      <section xml:id="_Ref485888623">
        <title>Stop</title>
        <para>A PTZ-capable device shall support the Stop operation. If no stop filter arguments are present, this command stops all ongoing pan, tilt and zoom movements. The Stop operation can be filtered to stop a specific movement by setting the corresponding stop argument.</para>
        <variablelist role="op">
          <varlistentry>
            <term>request</term>
            <listitem>
              <para role="param">ProfileToken [tt:ReferenceToken]</para>
              <para role="text">Reference to an existing media profile.</para>
              <para role="param">PanTilt - optional [xs:boolean]</para>
              <para role="text">Stop pan and tilt operation (defaults to true).</para>
              <para role="param">Zoom - optional [xs:boolean]</para>
              <para role="text">Stop zoom operation (defaults to true).</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>response</term>
            <listitem>
              <para role="text">This is an empty message.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>faults</term>
            <listitem>
              <para role="param">env:Sender - ter:InvalidArgVal - ter:NoProfile</para>
              <para role="text">The requested profile token ProfileToken does not exist.</para>
              <para role="param">env:Sender - ter:InvalidArgVal - ter:NoPTZProfile</para>
              <para role="text">The requested profile token does not reference a PTZ configuration.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>access class</term>
            <listitem>
              <para role="access">ACTUATE</para>
            </listitem>
          </varlistentry>
        </variablelist>
      </section>
      <section>
        <title>MoveAndStartTracking</title>
        <para>A device signaling MoveAndTrack in one of its PTZ nodes shall support this command. The purpose of this action is to send an an atomic command to the device: move the camera to a wanted position and then delegate the PTZ control to the tracking algorithm. With the atomic command the latency is minimized. The move position is optional and can be set in three different modes:</para>
        <itemizedlist>
          <listitem><para>By GeoLocation coordinates</para></listitem>
          <listitem><para>By a preset token</para></listitem>
          <listitem><para>By a PTZVector position</para></listitem>
        </itemizedlist>
		<para>An existing Speed argument overrides DefaultSpeed of the corresponding PTZ configuration during movement to the requested position. If spaces are referenced within the Speed argument, they shall be speed spaces supported by the PTZ node.</para> 
		<para>If the detection and the tracking are done in the same device, an ObjectID reference can be passed as an argument, in order to specify which object should be tracked.</para>
		<para>The operation shall fail if the requested absolute position is not reachable.</para> 
        <variablelist role="op">
          <varlistentry>
            <term>request</term>
            <listitem>
              <para role="param">ProfileToken [tt:ReferenceToken]</para>
              <para role="text">Reference to an existing media profile.</para>
              <para role="param">GeoLocation – optional [tt:GeoLocation]</para>
              <para role="text">Optional target coordinates</para>
              <para role="param">PresetToken – optional [tt:ReferenceToken]</para>
              <para role="text">Optional reference to an existing preset token.</para>
              <para role="param">TargetPosition – optional [tt:PTZVector]</para>
              <para role="text">Optional Vector specifying the absolute target position.</para>
              <para role="param">Speed - optional [tt:PTZSpeed]</para>
              <para role="text">Optional speed vector.</para>
              <para role="param">ObjectID - optional [tt:ObjectId]</para>
              <para role="text">Optional object ID of the object to track.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>response</term>
            <listitem>
              <para role="text">This is an empty message.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>faults</term>
            <listitem>
              <para role="param">env:Sender - ter:InvalidArgVal - ter:NoProfile</para>
              <para role="text">The requested profile token ProfileToken does not exist.</para>
              <para role="param">env:Sender - ter:InvalidArgVal - ter:NoPTZProfile</para>
              <para role="text">The requested profile token does not reference a PTZ configuration.</para>
              <para role="param">env:Sender - ter:InvalidArgVal - ter:SpaceNotSupported</para>
              <para role="text">A space is referenced that is not supported by the PTZ node.</para>
              <para role="param">env:Sender - ter:InvalidArgVal - ter:InvalidPosition</para>
              <para role="text">The requested position is out of bounds.</para>
              <para role="param">env:Sender - ter:InvalidArgVal - ter:InvalidSpeed</para>
              <para role="text">The requested speed is out of bounds.</para>
              <para role="param">env:Sender - ter:InvalidArgVal - ter:GeoMoveNotSupported</para>
              <para role="text">The device does not support geo move.</para>
              <para role="param">env:Sender - ter:InvalidArgVal - ter:UnreachablePosition</para>
              <para role="text">The requested translation is out of bounds.</para>
              <para role="param">env:Sender - ter:InvalidArgVal - ter:GeoLocationUnknown</para>
              <para role="text">The unit is not able to perform GeoMove because its geolocation is not configured or available.</para>
              <para role="param">env:Sender - ter:InvalidArgVal - ter:NoToken</para>
              <para role="text">The requested preset token does not exist.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>access class</term>
            <listitem>
              <para role="access">ACTUATE</para>
            </listitem>
          </varlistentry>
        </variablelist>
      </section>
      <section>
        <title>GetStatus</title>
        <para>A PTZ-capable device shall be able to report its PTZ status through the GetStatus command. The PTZ status contains the following information:</para>
        <itemizedlist>
          <listitem>
            <para>Position (optional) – Specifies the absolute position of the PTZ unit together with the space references. The default absolute spaces of the corresponding PTZ configuration shall be referenced within the position element. This information shall be present if the device signals support via the capability StatusPosition.</para>
          </listitem>
          <listitem>
            <para>MoveStatus (optional) – Indicates if the pan/tilt/zoom device unit is currently moving, idle or in an unknown state. This information shall be present if the device signals support via the capability MoveStatus. The state Unknown shall not be used during normal operation, but is reserved to initialization or error conditions.</para>
          </listitem>
          <listitem>
            <para>FieldOfView (optional) - Indicates the practically usable field of view of the camera after image processing.</para>
          </listitem>
          <listitem>
            <para>Error (optional) – States a current PTZ error condition. This field shall be present if the MoveStatus signals Unkown.</para>
          </listitem>
          <listitem>
            <para>UTC Time – Specifies the UTC time when this status was generated.</para>
          </listitem>
        </itemizedlist>
        <variablelist role="op">
          <varlistentry>
            <term>request</term>
            <listitem>
              <para role="param">ProfileToken [tt:ReferenceToken]</para>
              <para role="text">Reference to an existing media profile.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>response</term>
            <listitem>
              <para role="param">PTZStatus [tt:PTZStatus]</para>
              <para role="text">PTZStatus for the requested MediaProfile.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>faults</term>
            <listitem>
              <para role="param">env:Sender - ter:InvalidArgVal - ter:NoProfile</para>
              <para role="text">The requested profile token ProfileToken does not exist.</para>
              <para role="param">env:Sender - ter:InvalidArgVal - ter:NoPTZProfile</para>
              <para role="text">The requested profile token does not reference a PTZ configuration.</para>
              <para role="param">env:Receiver - ter:Action - ter:NoStatus</para>
              <para role="text">No PTZ status is available in the requested Media Profile.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>access class</term>
            <listitem>
              <para role="access">READ_MEDIA</para>
            </listitem>
          </varlistentry>
        </variablelist>
      </section>
    </section>
    <section>
      <title>Preset operations</title>
      <para>This section describes operations that manage the presets of a PTZ node. These operations shall be implemented for PTZ nodes supporting presets. All operations require a profile token referencing a media profile that includes a PTZConfiguration.</para>
      <section>
        <title>SetPreset</title>
        <para>The SetPreset command saves the current device position parameters so that the device can move to the saved preset position through the GotoPreset operation.</para>
        <para>If the PresetToken parameter is absent, the device shall create a new preset. Otherwise it shall update the stored position and optionally the name of the given preset. If creation is successful, the response contains the PresetToken which uniquely identifies the preset. An existing preset can be overwritten by specifying the PresetToken of the corresponding preset. In both cases (overwriting or creation) an optional PresetName can be specified. The operation fails if the PTZ device is moving during the SetPreset operation. </para>
        <para>The device may internally save additional states such as imaging properties in the PTZ preset which then should be recalled in the GotoPreset operation. A device shall accept a valid SetPresetRequest that does not include the optional element PresetName.</para>
        <para>Devices may require unique preset names and reject a request that contains an already existing PresetName by responding with the error message ter:PresetExist.</para>
        <variablelist role="op">
          <varlistentry>
            <term>request</term>
            <listitem>
              <para role="param">ProfileToken [tt:ReferenceToken]</para>
              <para role="text">Reference to an existing media profile.</para>
              <para role="param">PresetToken - optional [tt:ReferenceToken]</para>
              <para role="text">Optional existing preset token to update a preset position.</para>
              <para role="param">PresetName  - optional [xs:string]</para>
              <para role="text">Optional name to be assigned to the preset position.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>response</term>
            <listitem>
              <para role="param">PresetToken [tt:ReferenceToken]</para>
              <para role="text">Reference token assigned by the device to the preset.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>faults</term>
            <listitem>
              <para role="param">env:Sender - ter:InvalidArgVal - ter:NoProfile</para>
              <para role="text">The requested profile token ProfileToken does not exist.</para>
              <para role="param">env:Sender - ter:InvalidArgVal - ter:NoPTZProfile</para>
              <para role="text">Reference to an existing preset token.</para>
              <para role="param">env:Sender - ter:InvalidArgVal - ter:PresetExist</para>
              <para role="text">The requested name already exist for another preset.</para>
              <para role="param">env:Sender - ter:InvalidArgVal - ter:InvalidPresetName</para>
              <para role="text">The PresetName is either too long or contains invalid characters.</para>
              <para role="param">env:Sender - ter:InvalidArgVal - ter:NoToken</para>
              <para role="text">The requested preset token does not exist.</para>
              <para role="param">env:Receiver - ter:Action - ter:MovingPTZ</para>
              <para role="text">Preset cannot be set while PTZ unit is moving.</para>
              <para role="param">env:Receiver - ter:Action - ter:TooManyPresets</para>
              <para role="text">Maximum number of Presets reached.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>access class</term>
            <listitem>
              <para role="access">ACTUATE</para>
            </listitem>
          </varlistentry>
        </variablelist>
      </section>
      <section>
        <title>GetPresets</title>
        <para>The GetPresets operation returns the saved presets consisting of the following elements:</para>
        <itemizedlist>
          <listitem>
            <para>Token – A unique identifier to reference the preset.</para>
          </listitem>
          <listitem>
            <para>Name – An optional mnemonic name.</para>
          </listitem>
          <listitem>
            <para>PTZ Position – An optional absolute position. If the PTZ node supports absolute pan/tilt position spaces, the pan/tilt position shall be specified. If the PTZ node supports absolute zoom position spaces, the zoom position shall be specified.</para>
          </listitem>
        </itemizedlist>
        <variablelist role="op">
          <varlistentry>
            <term>request</term>
            <listitem>
              <para role="param">ProfileToken [tt:ReferenceToken]</para>
              <para role="text">Reference to an existing media profile.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>response</term>
            <listitem>
              <para role="param">Preset - optional, unbounded [tt:PTZPreset]</para>
              <para role="text">List of presets for the requested MediaProfile.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>faults</term>
            <listitem>
              <para role="param">env:Sender - ter:InvalidArgVal - ter:NoProfile</para>
              <para role="text">The requested profile token ProfileToken does not exist.</para>
              <para role="param">env:Sender - ter:InvalidArgVal - ter:NoPTZProfile</para>
              <para role="text">The requested profile token does not reference a PTZ configuration.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>access class</term>
            <listitem>
              <para role="access">READ_MEDIA</para>
            </listitem>
          </varlistentry>
        </variablelist>
      </section>
      <section>
        <title>GotoPreset</title>
        <para>The GotoPreset operation recalls a previously set preset. If the speed parameter is omitted, the default speed of the corresponding PTZ configuration shall be used. The speed parameter can only be specified when speed spaces are available for the PTZ node. The GotoPreset command is a non-blocking operation and can be interrupted by other move commands. </para>
        <variablelist role="op">
          <varlistentry>
            <term>request</term>
            <listitem>
              <para role="param">ProfileToken [tt:ReferenceToken]</para>
              <para role="text">Reference to an existing media profile.</para>
              <para role="param">PresetToken [tt:ReferenceToken]</para>
              <para role="text">Reference to an existing preset token.</para>
              <para role="param">Speed - optional [PTZSpeed]</para>
              <para role="text">Optional speed.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>response</term>
            <listitem>
              <para role="text">This is an empty message.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>faults</term>
            <listitem>
              <para role="param">env:Sender - ter:InvalidArgVal - ter:NoProfile</para>
              <para role="text">The requested profile token ProfileToken does not exist.</para>
              <para role="param">env:Sender - ter:InvalidArgVal - ter:NoPTZProfile</para>
              <para role="text">Reference to an existing preset token.</para>
              <para role="param">env:Sender - ter:InvalidArgVal - ter:NoToken</para>
              <para role="text">The requested preset token does not exist.</para>
              <para role="param">env:Sender - ter:InvalidArgVal - ter:SpaceNotSupported</para>
              <para role="text">A space that is not supported by the PTZ node is referenced.</para>
              <para role="param">env:Sender - ter:InvalidArgVal - ter:InvalidSpeed</para>
              <para role="text">The requested speed is out of bounds.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>access class</term>
            <listitem>
              <para role="access">ACTUATE</para>
            </listitem>
          </varlistentry>
        </variablelist>
      </section>
      <section>
        <title>RemovePreset</title>
        <para>The RemovePreset operation removes a previously set preset.</para>
        <variablelist role="op">
          <varlistentry>
            <term>request</term>
            <listitem>
              <para role="param">ProfileToken [tt:ReferenceToken]</para>
              <para role="text">Reference to an existing media profile.</para>
              <para role="param">PresetToken [tt:ReferenceToken]</para>
              <para role="text">Existing preset token to be removed.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>response</term>
            <listitem>
              <para role="text">This is an empty message.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>faults</term>
            <listitem>
              <para role="param">env:Sender - ter:InvalidArgVal - ter:NoProfile</para>
              <para role="text">The requested profile token ProfileToken does not exist.</para>
              <para role="param">env:Sender - ter:InvalidArgVal - ter:NoPTZProfile</para>
              <para role="text">Reference to an existing preset token.</para>
              <para role="param">env:Sender - ter:InvalidArgVal - ter:NoToken</para>
              <para role="text">The requested preset token does not exist.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>access class</term>
            <listitem>
              <para role="access">ACTUATE</para>
            </listitem>
          </varlistentry>
        </variablelist>
      </section>
    </section>
    <section>
      <title>Home position operations</title>
      <para>This section describes operations used to manage the home position of a PTZ node. These operations shall be implemented for PTZ nodes supporting home positions. All operations require a profile token referencing a media profile including a PTZConfiguration.</para>
      <para>The “home” position MAY be set by the SetHome operation or is a fix position of the PTZ unit.</para>
      <section>
        <title>GotoHomePosition</title>
        <para>This operation moves the PTZ unit to its home position. If the speed parameter is omitted, the default speed of the corresponding PTZ configuration shall be used. The speed parameter can only be specified when speed spaces are available for the PTZ node.The command is non-blocking and can be interrupted by other move commands.</para>
        <variablelist role="op">
          <varlistentry>
            <term>request</term>
            <listitem>
              <para role="param">ProfileToken [tt:ReferenceToken]</para>
              <para role="text">Reference to an existing media profile.</para>
              <para role="param">Speed - optional [PTZSpeed]</para>
              <para role="text">Optional speed.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>response</term>
            <listitem>
              <para role="text">This is an empty message.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>faults</term>
            <listitem>
              <para role="param">env:Sender - ter:InvalidArgVal - ter:NoProfile</para>
              <para role="text">The requested profile token ProfileToken does not exist.</para>
              <para role="param">env:Sender - ter:InvalidArgVal - ter:NoHomePosition</para>
              <para role="text">No home position has been defined for this Profile.</para>
              <para role="param">env:Sender - ter:InvalidArgVal - ter:NoPTZProfile</para>
              <para role="text">Reference to an existing preset token.</para>
              <para role="param">env:Sender - ter:InvalidArgVal - ter:InvalidSpeed</para>
              <para role="text">The requested speed is out of bounds.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>access class</term>
            <listitem>
              <para role="access">ACTUATE</para>
            </listitem>
          </varlistentry>
        </variablelist>
      </section>
      <section>
        <title>SetHomePosition</title>
        <para>The SetHome operation saves the current position parameters as the home position, so that the GotoHome operation can request that the device move to the home position.</para>
        <para>The SetHomePosition command shall return with a failure if the “home” position is fixed and cannot be overwritten. If the SetHomePosition is successful, it shall be possible to recall the home position with the GotoHomePosition command.</para>
        <variablelist role="op">
          <varlistentry>
            <term>request</term>
            <listitem>
              <para role="param">ProfileToken [tt:ReferenceToken]</para>
              <para role="text">Reference to an existing media profile.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>response</term>
            <listitem>
              <para role="text">This is an empty message.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>faults</term>
            <listitem>
              <para role="param">env:Sender - ter:InvalidArgVal - ter:NoProfile</para>
              <para role="text">The requested profile token ProfileToken does not exist.</para>
              <para role="param">env:Sender - ter:InvalidArgVal - ter:NoPTZProfile</para>
              <para role="text">Reference to an existing preset token.</para>
              <para role="param">env:Receiver - ter:Action - ter:CannotOverwriteHome</para>
              <para role="text">The home position is fixed and cannot be overwritten.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>access class</term>
            <listitem>
              <para role="access">ACTUATE</para>
            </listitem>
          </varlistentry>
        </variablelist>
      </section>
    </section>
    <section>
      <title>Auxiliary operations</title>
      <para>This section describes operations to manage auxiliary commands of a PTZ node, such as an infrared (IR) lamp, a heater or a wiper.</para>
      <para>These operations shall be implemented for PTZ nodes indicating auxiliary commands in the node properties. All operations require a profile token referencing a media profile that includes a PTZConfiguration.</para>
      <section>
        <title>SendAuxiliaryCommand</title>
        <para>This operation is used to call an auxiliary operation on the device. The supported commands can be retrieved via the PTZ node properties. The auxiliary command should match the supported command listed in the PTZ node; no other syntax is supported. If the PTZ node lists the tt:IRLamp command, then the parameter of AuxiliaryCommand command shall conform to the syntax specified in Section 8.6 Auxiliary operation of ONVIF Core Specification. The SendAuxiliaryCommand shall be implemented when the PTZ node supports auxiliary commands.</para>
        <variablelist role="op">
          <varlistentry>
            <term>request</term>
            <listitem>
              <para role="param">ProfileToken [tt:ReferenceToken]</para>
              <para role="text">Reference to an existing media profile.</para>
              <para role="param">AuxiliaryData [tt:AuxiliaryData]</para>
              <para role="text">Auxiliary command to be applied.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>response</term>
            <listitem>
              <para role="param">AuxiliaryResponse[tt:AuxiliaryData]</para>
              <para role="text">Auxiliary response information.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>faults</term>
            <listitem>
              <para role="param">env:Sender - ter:InvalidArgVal - ter:NoProfile</para>
              <para role="text">The requested profile token ProfileToken does not exist.</para>
              <para role="param">env:Sender - ter:InvalidArgVal - ter:NoPTZProfile</para>
              <para role="text">Reference to an existing preset token.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>access class</term>
            <listitem>
              <para role="access">ACTUATE</para>
            </listitem>
          </varlistentry>
        </variablelist>
      </section>
    </section>
    <section xml:id="_Toc214944449">
      <title>Predefined PTZ Spaces</title>
      <para>Spaces are used to specify absolute, relative and continuous movements. Whereas absolute movements require an absolute position, relative movements are specified by a position translation. Continuous movements require the specification of a velocity (relative movement over time). For these three cases, different coordinate systems are used describing the desired movement. The generic spaces do not absolutely specify the underlying PTZ model, so that it can be applied to any PTZ hardware. </para>
      <para>Note: this document includes additional non-normative spaces defined in <xref linkend="_additionalSpaces"/>.</para>
      <section>
        <title>Absolute position spaces</title>
        <para>The absolute position spaces are used when the client wants to move the camera to a certain position.  The  absolute  movement from  current  position  A  to  an  arbitrarily chosen  position  B doesn’t have to follow a specific path. Instead, the PTZ device may choose the shortest path in order to reach the target destination.</para>
        <para>For devices with dynamic ranges of values (for example, enabling or disabling a "digital zoom" feature will change the total zoom range), it is expected that the generic spaces will be remapped at runtime to match the full range of values.</para>
        <section>
          <title>Generic pan/tilt position space</title>
          <para>The generic pan/tilt position space shall be provided by every PTZ node that supports absolute pan/tilt, since it does not relate to a specific physical range. Instead, the range should be defined as the full range of the PTZ unit normalized to the range -1 to 1 resulting in the following space description:</para>
          <programlisting><![CDATA[<tt:AbsolutePanTiltPositionSpace>
  <tt:SpaceURI>
    http://www.onvif.org/ver10/tptz/PanTiltSpaces/PositionGenericSpace
  </tt:SpaceURI>
  <tt:Xrange>
    <tt:Min>-1.0</tt:Min>
    <tt:Max>1.0</tt:Max>
  </tt:Xrange>
  <tt:Yrange>
    <tt:Min>-1.0</tt:Min>
    <tt:Max>1.0</tt:Max>
  </tt:Yrange>
</tt:AbsolutePanTiltPositionSpace>
]]></programlisting>
        </section>
        <section xml:id="_Ref469301646">
          <title>Spherical pan/tilt position space in degrees</title>
          <para>
            <xref linkend="_Ref469303432" /> shows a camera with pan and tilt mechanics and the corresponding spherical coordinate system. The space description assumes that the dome is mounted on the ceiling. The definition of a Pan movement is the rotation of the camera module around the pan axis. Thereby, the tilt axis is also rotated in the same direction in the plane orthogonal to the pan axis, so that it is still orthogonal to the camera lens axis. Tilt movement is the rotation of the camera module around the tilt axis. W ith the tilt axis the camera direction can be changed from looking downward to looking at the horizon. Some devices may support a camera which can look above the horizon.</para>
          <para>The angles describing the rotation around pan and tilt axis are referred to as pan and tilt angles, where pan is represented by the X coordinate of the position vector and tilt is represented by the Y coordinate of the position vector. Both angles are specified in degrees. The initial position of this coordinate system is when the direction of the camera lens is parallel to the ceiling. The pan and tilt angles in this initial direction are zero (0,0).</para>
          <para>When starting from the initial direction and increasing the pan angle, objects that have previously been in the centre of the image will move towards the left of the image. When starting from the initial direction and increasing the tilt angle, objects which have been previously in the middle of the image move towards the bottom of the image.</para>
          <para>The maximum range for pan and tilt angles are between -180 and +180 degrees <footnote xml:id="__FN1__"><para>-180 and +180 is the same pan position in the space and the camera can choose to represent the pan position using any of them</para></footnote>. The device can restrict the tilt range arbitrarily. The tilt angle of a camera can change its direction in the space of a hemisphere like a dome camera that is typically bounded from 0 to -90 degrees. If a device cannot pan the full range, it may limit the pan range to an appropriate interval.</para>
          <figure xml:id="_Ref469303432">
            <title>Spherical pan/tilt position space in degrees for a camera mounted on the ceiling.</title>
            <mediaobject>
              <imageobject>
                <imagedata fileref="media/Ptz/image2.svg" contentwidth="80mm" />
              </imageobject>
            </mediaobject>
          </figure>
          <para>A camera that does not support e-flip (or has disabled it) and allows an absolute tilt range between</para>
          <para>0 and -180°, shall not rotate the image and directions when requesting a tilt movement of less than -90°.</para>
          <para>If a camera supports e-flip and a client requests a tilt movement that passes nadir, the following behaviour is to be expected:</para>
          <itemizedlist>
            <listitem>
              <para>There could be a hysteresis (±α°) room around the position of nadir, such that the image and direction rotation doesn’t occur exactly at the nadir, which could generate irritating oscillation.</para>
            </listitem>
            <listitem>
              <para>When the camera rotates the image and move directions (after passing the nadir ±α°), the following changes to the coordinate system will occur:</para>
              <itemizedlist>
                <listitem>
                  <para>The new pan angle will be <emphasis>P</emphasis><subscript>new</subscript> = <emphasis>P</emphasis><subscript>old</subscript> + 180° </para>
                </listitem>
                <listitem>
                  <para>The new tilt angle will be <emphasis>T</emphasis><subscript>new</subscript> = -180°<inlinemediaobject><imageobject><imagedata fileref="media/Ptz/image3.png" contentwidth="11" contentdepth="17" /></imageobject></inlinemediaobject><inlinemediaobject><imageobject><imagedata fileref="media/Ptz/image4.png" contentwidth="16" contentdepth="17" /></imageobject></inlinemediaobject><inlinemediaobject><imageobject><imagedata fileref="media/Ptz/image4.png" contentwidth="16" contentdepth="17" /></imageobject></inlinemediaobject> - <emphasis>T</emphasis><subscript>old</subscript> , -180 ≤ <emphasis>T</emphasis><subscript>old</subscript> ≤ -90</para>
                </listitem>
                <listitem>
                  <para>If ignoring the hysteresis area, there is a one-to-one mapping between viewing directions  and   pan/tilt  coordinates,  even   though  there   are   two   mechanical positions  of  the  camera  matching  the  same  viewing  direction  but  with  rotated image. For example, the two mechanical directions <emphasis>P</emphasis><subscript>1</subscript> : 35 , <emphasis>T</emphasis><subscript>1</subscript> : -20 and <emphasis>P</emphasis><subscript>2</subscript> : -145 , <emphasis>T</emphasis><subscript>2</subscript> : -160 , would be represented by the coordinate <emphasis>P</emphasis> : 35 , <emphasis>T</emphasis> : -20 since a tilt of &lt; -90 – α would update the coordinates as described above.</para>
                </listitem>
              </itemizedlist>
            </listitem>
          </itemizedlist>
          <para>The spherical pan/tilt position space is defined as follows:  <footnote xml:id="__FN2__"><para>The  particular  device  should  reference  the  proposed  name  space  but  the  actual  ranges  are  device  specific.  The ranges indicated in the definition shall be interpreted as the maximum and minimum range limits for the space.</para></footnote></para>
          <programlisting><![CDATA[<tt:AbsolutePanTiltPositionSpace>
  <tt:SpaceURI>
    http://www.onvif.org/ver10/tptz/PanTiltSpaces/SphericalPositionSpace
    Degrees
  </tt:SpaceURI>
  <tt:XRange>
    <tt:Min>-INF</tt:Min>
    <tt:Max>INF</tt:Max>
  </tt:XRange>
  <tt:YRange>
    <tt:Min>-180.0</tt:Min>
    <tt:Max>180.0</tt:Max>
  </tt:YRange>
</tt:AbsolutePanTiltPositionSpace>
]]></programlisting>
          <para>The Min and Max elements of the XRange are set to plus and minus infinity to indicate that the range is not bounded to either side.</para>
        </section>
        <section>
          <title>Generic zoom position space</title>
          <para>The generic zoom position space shall be provided by every PTZ node that supports absolute zoom, since it does not relate to a specific physical range. Instead, the range should be defined as the full range of the zoom normalized to the range 0 (wide) to 1 (tele). There is no assumption about how the generic zoom range is mapped to magnification, FOV or other physical zoom dimension. This results in the following space description:</para>
          <programlisting><![CDATA[<tt:AbsoluteZoomPositionSpace>
  <tt:SpaceURI>
    http://www.onvif.org/ver10/tptz/ZoomSpaces/PositionGenericSpace
  </tt:SpaceURI>
  <tt:Xrange>
    <tt:Min>0.0</tt:Min>
    <tt:Max>1.0</tt:Max>
  </tt:Xrange>
</tt:AbsoluteZoomPositionSpace>
]]></programlisting>
        </section>
        <section xml:id="_Ref469302989">
          <title>Zoom position space in millimeters</title>
          <para>The zoom position space in millimeters expresses the absolute focal length of a zoom camera. The maximum  and minimum focal length is camera specific. The zoom position  space  in millimeters is defined as follows: <footnote xml:id="__FN3__"><para>The particular device should reference the proposed name space but the actual range is device specific. The range indicated in the definition shall be interpreted as the maximum and minimum range limits for the space.</para></footnote></para>
          <programlisting><![CDATA[<tt:AbsoluteZoomPositionSpace>
  <tt:SpaceURI>
    http://www.onvif.org/ver10/tptz/ZoomSpaces/PositionSpaceMillimeter
  </tt:SpaceURI>
  <tt:XRange>
    <tt:Min>0.0</tt:Min>
    <tt:Max>INF</tt:Max>
  </tt:XRange>
</tt:AbsoluteZoomPositionSpace>
]]></programlisting>
          <para>The current zoom magnification (M) for a camera can be calculated from the focal length as follows:</para>
          <para>
            <inlineequation>
              <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML">
                <mml:mi>M</mml:mi>
                <mml:mo>=</mml:mo>
                <mml:mfrac>
                  <mml:mrow>
                    <mml:mi>f</mml:mi>
                    <mml:mi>c</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>f</mml:mi>
                    <mml:mn>0</mml:mn>
                  </mml:mrow>
                </mml:mfrac>
                <mml:mi>
                </mml:mi>
                <mml:mo>,</mml:mo>
              </mml:math>
            </inlineequation>
          </para>
          <para>where <inlineequation><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>f</mml:mi><mml:mn>0</mml:mn></mml:math></inlineequation> is the minimum focal length and <inlineequation><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>f</mml:mi><mml:mi>c</mml:mi></mml:math></inlineequation> is the current focal length.</para>
          <para>The current angle of view can be calculated with the following formula:</para>
          <para>
            <inlineequation>
              <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML">
                <mml:mo>∝</mml:mo>
                <mml:mi>
                </mml:mi>
                <mml:mo>=</mml:mo>
                <mml:mi>
                </mml:mi>
                <mml:mn>2</mml:mn>
                <mml:mi>
                </mml:mi>
                <mml:mi mathvariant="normal">a</mml:mi>
                <mml:mi mathvariant="normal">r</mml:mi>
                <mml:mi mathvariant="normal">c</mml:mi>
                <mml:mi mathvariant="normal">t</mml:mi>
                <mml:mi mathvariant="normal">a</mml:mi>
                <mml:mi mathvariant="normal">n</mml:mi>
                <mml:mfrac>
                  <mml:mrow>
                    <mml:mi>d</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mn>2</mml:mn>
                    <mml:mi>f</mml:mi>
                    <mml:mi>c</mml:mi>
                  </mml:mrow>
                </mml:mfrac>
                <mml:mi>
                </mml:mi>
                <mml:mi>
                </mml:mi>
                <mml:mo>,</mml:mo>
              </mml:math>
            </inlineequation>
          </para>
          <para>where <inlineequation><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>d</mml:mi></mml:math></inlineequation> represents the size of the sensor in the direction of interest and <inlineequation><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>f</mml:mi><mml:mi>c</mml:mi></mml:math></inlineequation> is the current focal length.</para>
        </section>
        <section xml:id="_Ref469302658">
          <title>Normalized digital zoom position space</title>
          <para>The normalized digital zoom position space represents the mapping between the width of the window (Ww) used for a video stream and the width of the Bounds element of the video source configuration (Sw). This space requires a Media Profile that includes a VideoEncoderConfiguration and a VideoSourceConfiguration.</para>
          <para>The normalized digital zoom factor is calculated as 	<inlineequation><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>Z</mml:mi><mml:mi></mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi></mml:mi><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mi>W</mml:mi><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>S</mml:mi><mml:mi>w</mml:mi></mml:mrow></mml:mfrac><mml:mo>)</mml:mo><mml:mi></mml:mi></mml:math></inlineequation> .</para>
          <para>The maximum zoom level that can be represented by this space is limited by the smallest size of the window allowed by the camera.</para>
          <para>The normalized digital position zoom space is defined as follows: <footnote xml:id="__FN4__"><para>The particular device should reference the proposed name space but the actual range is device specific. The range indicated in the definition shall be interpreted as the maximum range limit for the space.</para></footnote></para>
          <programlisting><![CDATA[<tt:AbsoluteZoomPositionSpace>
  <tt:SpaceURI>
    http://www.onvif.org/ver10/tptz/ZoomSpaces/NormalizedDigitalPosition
    Space
  </tt:SpaceURI>
  <tt:XRange>
    <tt:Min>1.0</tt:Min>
    <tt:Max>INF</tt:Max>
  </tt:XRange>
</tt:AbsoluteZoomPositionSpace>
]]></programlisting>
          <para>It’s  important  to  notice  that  a  zoom  operation  using  this  space  doesn’t  affect  the  current resolution of the video stream being configured in the VideoEncoderConfiguration of the Media Profile. Instead it changes the width and height of the window configured in the VideoSourceConfiguration.</para>
          <section>
            <title>Example: Zoom level for cropped area</title>
            <para>For example, a digital PTZ unit with a natively cropped VGA (640x 480) window on a 3MP sensor (2048x1536) would have the zoom level  <inlineequation><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>Z</mml:mi><mml:mi></mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mi></mml:mi><mml:mo>/</mml:mo><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mn>640</mml:mn></mml:mrow><mml:mrow><mml:mn>2048</mml:mn></mml:mrow></mml:mfrac><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mn>3.2</mml:mn><mml:mo>.</mml:mo></mml:math></inlineequation></para>
          </section>
        </section>
      </section>
      <section>
        <title>Relative translation spaces</title>
        <para>A Relative pan/tilt Translation Space moves the PTZ unit a certain translation in a certain direction without knowing the camera’s current pan/tilt position.</para>
        <para>A relative pan/tilt translation can be derived from a corresponding (digital/spherical) absolute pan/tilt position space  by taking the difference of  two  absolute pan/tilt positions. However, there are also relative pan/tilt translations where no corresponding absolute pan/tilt space can be defined. An example is the relative translation space in field of view described in Section  <xref linkend="_Ref469301844" />.</para>
        <para>If the camera supports e-flip, the following additional behaviour should be expected by the space defined in Section <xref linkend="_Ref469301263" />:</para>
        <para>If the tilt translation is passing nadir position (including the room for a hysteresis ±α°), the camera should rotate the image at nadir ±α° as described in section <xref linkend="_Ref469301646" /> (only for cameras supporting absolute pan/tilt positioning). When a rotation occurs, the camera will continue the current movements according to the directions given when the command was issued. If the command is interrupted with a new request (after the flip), that request will be handled according to the new (flipped) direction and coordinates. A camera that doesn’t support e-flip or has it disabled will not rotate the image and directions during a tilt movement passing the nadir.</para>
        <section>
          <title>Generic pan/tilt translation space</title>
          <para>The generic pan/tilt translation space shall be provided by every PTZ node that supports relative pan/tilt, since it does not relate to a specific physical range. Instead, the range should be defined as the full positive and negative translation range of the PTZ unit normalized to the range -1 to 1, where positive translation would mean clockwise rotation or movement in right/up direction resulting in the following space description:</para>
          <programlisting><![CDATA[<tt:RelativePanTiltTranslationSpace>
  <tt:SpaceURI>
    http://www.onvif.org/ver10/tptz/PanTiltSpaces/TranslationGenericSpace
  </tt:SpaceURI>
  <tt:Xrange>
    <tt:Min>-1.0</tt:Min>
    <tt:Max>1.0</tt:Max>
  </tt:Xrange>
  <tt:Yrange>
    <tt:Min>-1.0</tt:Min>
    <tt:Max>1.0</tt:Max>
  </tt:Yrange>
</tt:RelativePanTiltTranslationSpace>
]]></programlisting>
        </section>
        <section>
          <title>Generic zoom translation space</title>
          <para>The generic zoom translation space shall be provided by every PTZ node that supports relative zoom, since it does not relate to a specific physical range. Instead, the corresponding absolute range should be defined as the full positive and negative translation range of the Zoom normalized to the range -1 to1, where a positive translation maps to a movement in tele direction. The translation is signed to indicate direction (negative is to wide, positive is to tele). There is no assumption about how the generic zoom range is mapped to magnification, field of view or other physical zoom dimension. This results in the following space description:</para>
          <programlisting><![CDATA[<tt:RelativeZoomTranslationSpace>
  <tt:SpaceURI>
    http://www.onvif.org/ver10/tptz/ZoomSpaces/TranslationGenericSpace
  </tt:SpaceURI>
  <tt:Xrange>
    <tt:Min>-1.0</tt:Min>
    <tt:Max>1.0</tt:Max>
  </tt:Xrange>
</tt:RelativeZoomTranslationSpace>
]]></programlisting>
        </section>
      </section>
      <section>
        <title>Continuous velocity spaces</title>
        <para>The continuous velocity spaces are used to continuously move the PTZ unit in a certain direction.</para>
        <para>If a camera supports e-flip (specified in section <xref linkend="_Ref469301263" />), and it’s enabled, the following behaviour should be expected by the pan/tilt spaces defined in Section <xref linkend="_Ref469301326" /> and <xref linkend="_Ref469301599" />:</para>
        <para>If the tilt translation is passing nadir position (including the room for a hysteresis ±α°), the  camera should rotate the image at nadir ±α° as described in section <xref linkend="_Ref469301646" /> (only for cameras supporting absolute pan/tilt positioning). When a rotation occurs, the camera will continue the current movements according to the directions given when the command was issued. If the command is interrupted with a new request (after the flip), that request will be handled according to the new (flipped) direction and  coordinates. A camera that doesn’t support e-flip or has it disabled will not rotate the image and directions during a tilt movement passing nadir.</para>
        <section>
          <title>Generic pan/tilt velocity space</title>
          <para>The generic pan/tilt velocity space shall be provided by every PTZ node, since it does not relate to a specific physical range. Instead, the range should be defined as a range of the PTZ unit’s speed normalized to the range -1 to 1, where a positive velocity would map to clockwise rotation or movement in the right/up direction. A signed speed can be independently specified for the pan and tilt component resulting in the following space description:</para>
          <programlisting><![CDATA[<tt:ContinuousPanTiltVelocitySpace>
  <tt:SpaceURI>
    http://www.onvif.org/ver10/tptz/PanTiltSpaces/VelocityGenericSpace
  </tt:SpaceURI>
  <tt:Xrange>
    <tt:Min>-1.0</tt:Min>
    <tt:Max>1.0</tt:Max>
  </tt:Xrange>
  <tt:Yrange>
    <tt:Min>-1.0</tt:Min>
    <tt:Max>1.0</tt:Max>
  </tt:Yrange>
</tt:ContinuousPanTiltVelocitySpace>
]]></programlisting>
        </section>
        <section xml:id="_Ref469301326">
          <title>pan/tilt Velocity Space in Degrees per Second</title>
          <para>The pan/tilt Velocity Space In Degrees Per Second describes a continuous rotation around the pan and tilt axis (specified in section <xref linkend="_Ref469301646" />) with a constant rotation speed. Thereby, the velocity describes  the  signed  pan  and  tilt  angle  change  in  degrees  per  second.  The  pan  velocity  is expressed by the X coordinate of the direction vector and the tilt velocity by the Y coordinate and the space is defined as follows: <footnote xml:id="__FN5__"><para>The particular device should reference the proposed name space but the actual ranges are device specific. The ranges indicated in the definition shall be interpreted as the maximum and minimum range limits for the space.</para></footnote></para>
          <programlisting><![CDATA[<tt:ContinuousPanTiltVelocitySpace>
  <tt:SpaceURI>
    http://www.onvif.org/ver10/tptz/PanTiltSpaces/VelocitySpaceDegrees
  </tt:SpaceURI>
  <tt:XRange>
    <tt:Min>-INF</tt:Min>
    <tt:Max>INF</tt:Max>
  </tt:XRange>
  <tt:YRange>
    <tt:Min>-INF</tt:Min>
    <tt:Max>INF</tt:Max>
  </tt:YRange>
</tt:ContinuousPanTiltVelocitySpace>
]]></programlisting>
        </section>
        <section>
          <title>Generic zoom velocity space</title>
          <para>The generic zoom velocity space specifies a zoom factor velocity without knowing the underlying physical model. The range should be normalized from -1 to 1, where a positive velocity would map to TELE direction. A generic zoom velocity space description resembles the following:</para>
          <programlisting><![CDATA[<tt:ContinuousZoomVelocitySpace>
  <tt:SpaceURI>
    http://www.onvif.org/ver10/tptz/ZoomSpaces/VelocityGenericSpace
  </tt:SpaceURI>
  <tt:Xrange>
    <tt:Min>-1.0</tt:Min>
    <tt:Max>1.0</tt:Max>
  </tt:Xrange>
</tt:ContinuousZoomVelocitySpace>
]]></programlisting>
        </section>
      </section>
      <section>
        <title>Speed spaces</title>
        <para>The speed spaces specify the speed for a pan/tilt and zoom movement when moving to an absolute position or to a relative translation. In contrast to the velocity spaces, speed spaces do not contain any directional information. The speed of a combined pan/tilt movement is represented by a single non-negative scalar value.</para>
        <para>If   relative   translation   space   and   continuous   velocity  space   are   already   defined,   the corresponding speed space is derived as follows: requesting a continuous movement with a velocity  V  for  T  seconds,  is  identical  (up  to  acceleration  and  positional  inaccuracies)  to requesting a relative movement with relative position R and speed S, where R equals V times T and S equals the length of vector V. Therefore, speed values are always positive.</para>
        <section>
          <title>Generic pan/tilt speed space</title>
          <para>The generic pan/tilt speed space shall be provided by every PTZ node that supports configurable speed for pan/tilt, since it does not relate to a specific physical range. Instead, the range should be defined as the full range of the speed range normalized to the range 0 (stopped) to 1 (full speed). This results in the following space description:</para>
          <programlisting><![CDATA[<tt:PanTiltSpeedSpace>
  <tt:SpaceURI>
    http://www.onvif.org/ver10/tptz/PanTiltSpaces/GenericSpeedSpace
  </tt:SpaceURI>
  <tt:Xrange>
    <tt:Min>0.0</tt:Min>
    <tt:Max>1.0</tt:Max>
  </tt:Xrange>
</tt:PanTiltSpeedSpace>
]]></programlisting>
        </section>
        <section>
          <title>Pan/tilt speed space in degrees per Second</title>
          <para>The pan/tilt speed space in degrees per second derives from the absolute pan/tilt position space in degrees for absolute and relative movements. The pan/tilt speed space in degrees per second is defined as follows: <footnote xml:id="__FN6__"><para>The particular device should reference the proposed name space but the actual range is device specific. The range indicated in the definition shall be interpreted as the maximum and minimum range limits for the space.</para></footnote></para>
          <programlisting><![CDATA[<tt:PanTiltSpeedSpace>
  <tt:SpaceURI>
    http://www.onvif.org/ver10/tptz/PanTiltSpaces/SpeedSpaceDegrees
  </tt:SpaceURI>
  <tt:XRange>
    <tt:Min>0.0</tt:Min>
    <tt:Max>INF</tt:Max>
  </tt:XRange>
</tt:PanTiltSpeedSpace>
]]></programlisting>
        </section>
        <section>
          <title>Generic zoom speed space</title>
          <para>The generic zoom speed space shall be provided by every PTZ node that supports configurable speed for zoom, since it does not relate to a specific physical range. Instead, the range should be defined as the full range of the speed range normalized to the range 0 (stopped) to 1 (full speed). This results in the following space description:</para>
          <programlisting><![CDATA[<tt:ZoomSpeedSpace>
  <tt:SpaceURI>
    http://www.onvif.org/ver10/tptz/ZoomSpaces/ZoomGenericSpeedSpace
  </tt:SpaceURI>
  <tt:Xrange>
    <tt:Min>0.0</tt:Min>
    <tt:Max>1.0</tt:Max>
  </tt:Xrange>
</tt:ZoomSpeedSpace>
]]></programlisting>
        </section>
        <section>
          <title>Zoom speed space in millimeter per second</title>
          <para>The  zoom  speed  space  in  millimeter  per  second  derives  from  the  zoom  velocity space  in millimeter per second as defined in section <xref linkend="_Ref469468775" /> and specifies the absolute change per second of the focal length. If the device supports the zoom speed space The zoom speed space in millimeter per second is defined as follows:<footnote xml:id="__FN7__"><para>The particular device should reference the proposed name space but the actual range is device specific. The range indicated in the definition shall be interpreted as the maximum and minimum range limit for the space.</para></footnote></para>
          <programlisting><![CDATA[<tt:ZoomSpeedSpace>
  <tt:SpaceURI>
    http://www.onvif.org/ver10/tptz/ZoomSpaces/SpeedSpaceMillimeter
  </tt:SpaceURI>
  <tt:XRange>
    <tt:Min>0.0</tt:Min>
    <tt:Max>INF</tt:Max>
  </tt:XRange>
</tt:ZoomSpeedSpace>
]]></programlisting>
        </section>
      </section>
    </section>
    <section>
      <title>Preset Tour Operations</title>
      <para>Preset tour is a feature for PTZ-capable devices, enabling the PTZ unit to move on specified presets sequentially at some  interval.</para>
      <para>This section describes operations that manage the preset tours. These operations shall be implemented when a PTZ node in the PTZ service indicates support of preset tours with MaximumNumberOfPresetTours&gt;0 capability value, All operations require a profile token referencing a Media Profile including a PTZConfiguration. All operations for preset tours shall always be persistent.</para>
      <para>PresetTours can have forward and backward directions, and in case direction is omitted, it is assumed to be forward. However, it is possible to specify random execution by setting the RandomPresetOrder attribute. In case RandomPresetOrder is set to true and Direction is also present, Direction will be ignored and presets of the Tour will be recalled randomly.</para>
      <section>
        <title>GetPresetTours</title>
        <para>A device supporting Preset Tour feature shall return all available preset tours through GetPresetTours.</para>
        <variablelist role="op">
          <varlistentry>
            <term>request</term>
            <listitem>
              <para role="param">ProfileToken [tt:ReferenceToken]</para>
              <para role="text">Reference to an existing media profile.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>response</term>
            <listitem>
              <para role="param">PresetTour - optional, unbounded [tt:PTZPresetTour]</para>
              <para role="text">List of preset tours defined for the requested MediaProfile.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>faults</term>
            <listitem>
              <para role="param">env:Sender - ter:InvalidArgVal - ter:NoProfile</para>
              <para role="text">The requested profile token ProfileToken does not exist.</para>
              <para role="param">env:Sender - ter:InvalidArgVal - ter:NoPTZProfile</para>
              <para role="text">The requested profile token does not reference a PTZ configuration.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>access class</term>
            <listitem>
              <para role="access">READ_MEDIA</para>
            </listitem>
          </varlistentry>
        </variablelist>
      </section>
      <section>
        <title>GetPresetTour</title>
        <para>A device supporting preset tours shall return the requested preset tour through GetPresetTour.</para>
        <variablelist role="op">
          <varlistentry>
            <term>request</term>
            <listitem>
              <para role="param">ProfileToken [tt:ReferenceToken]</para>
              <para role="text">Reference to an existing media profile.</para>
              <para role="param">PresetTourToken [tt:ReferenceToken]</para>
              <para role="text">Reference to an existing preset tour.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>response</term>
            <listitem>
              <para role="param">PresetTour [tt:PTZPresetTour]</para>
              <para role="text">The requested preset tour.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>faults</term>
            <listitem>
              <para role="param">env:Sender - ter:InvalidArgVal - ter:NoProfile</para>
              <para role="text">The requested profile token does not exist.</para>
              <para role="param">env:Sender - ter:InvalidArgVal - ter:NoPTZProfile</para>
              <para role="text">The requested profile token does not reference a PTZ configuration.</para>
              <para role="param">env:Sender - ter:InvalidArgVal - ter:NoToken</para>
              <para role="text">The requested preset tour token does not exist.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>access class</term>
            <listitem>
              <para role="access">READ_MEDIA</para>
            </listitem>
          </varlistentry>
        </variablelist>
      </section>
      <section>
        <title>GetPresetTourOptions</title>
        <para>A device supporting preset tours shall provide options for how preset tours can be configured through GetPresetTourOptions.</para>
        <variablelist role="op">
          <varlistentry>
            <term>request</term>
            <listitem>
              <para role="param">ProfileToken [tt:ReferenceToken]</para>
              <para role="text">Reference to an existing media profile.</para>
              <para role="param">PresetTourToken - optional [tt:ReferenceToken]</para>
              <para role="text">Optional reference to an existing preset tour.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>response</term>
            <listitem>
              <para role="param">PresetTour [tt:PTZPresetTourOptions]</para>
              <para role="text">The requested preset tour options.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>faults</term>
            <listitem>
              <para role="param">env:Sender - ter:InvalidArgVal - ter:NoProfile</para>
              <para role="text">The requested profile token does not exist.</para>
              <para role="param">env:Sender - ter:InvalidArgVal - ter:NoPTZProfile</para>
              <para role="text">The requested profile token does not reference a PTZ configuration.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>access class</term>
            <listitem>
              <para role="access">READ_MEDIA</para>
            </listitem>
          </varlistentry>
        </variablelist>
      </section>
      <section>
        <title>CreatePresetTour</title>
        <para>A device supporting Preset Tour feature shall allow creating a new Preset Tour through the CreatePresetTour.</para>
        <variablelist role="op">
          <varlistentry>
            <term>request</term>
            <listitem>
              <para role="param">ProfileToken [tt:ReferenceToken]</para>
              <para role="text">Reference to an existing media profile.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>response</term>
            <listitem>
              <para role="param">PresetTourToken [tt:ReferenceToken]</para>
              <para role="text">Reference to an existing preset tour.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>faults</term>
            <listitem>
              <para role="param">env:Sender - ter:InvalidArgVal - ter:NoProfile</para>
              <para role="text">The requested profile token ProfileToken does not exist.</para>
              <para role="param">env:Sender - ter:InvalidArgVal - ter:NoPTZProfile</para>
              <para role="text">The requested profile token does not reference a PTZ configuration.</para>
              <para role="param">env:Sender - ter:InvalidArgVal - ter:TooManyPresetTours</para>
              <para role="text">There is not enough space in the device to create the new preset tour for the profile</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>access class</term>
            <listitem>
              <para role="access">ACTUATE</para>
            </listitem>
          </varlistentry>
        </variablelist>
      </section>
      <section>
        <title>ModifyPresetTour</title>
        <para>A device supporting preset tours shall allow modifying a preset tour through ModifyPresetTour.</para>
        <variablelist role="op">
          <varlistentry>
            <term>request</term>
            <listitem>
              <para role="param">ProfileToken [tt:ReferenceToken]</para>
              <para role="text">Reference to an existing media profile.</para>
              <para role="param">PresetTour [tt:PTZPresetTour]</para>
              <para role="text">The preset tour parameters to be set.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>response</term>
            <listitem>
              <para role="text">This is an empty message.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>faults</term>
            <listitem>
              <para role="param">env:Sender - ter:InvalidArgVal - ter:NoProfile</para>
              <para role="text">The requested profile token does not exist.</para>
              <para role="param">env:Sender - ter:InvalidArgVal - ter:NoPTZProfile</para>
              <para role="text">The requested profile token does not reference a PTZ configuration.</para>
              <para role="param">env:Sender - ter:InvalidArgVal - ter:<phrase>InvalidPresetTour</phrase></para>
              <para role="text">The requested PresetTour includes invalid parameter(s).</para>
              <para role="param">env:Sender - ter:InvalidArgVal - ter:TooManyPresets</para>
              <para role="text">Too many TourSpots are included in the PresetTour.</para>
              <para role="param">env:Sender - ter:InvalidArgVal - ter:NoToken</para>
              <para role="text">The requested preset tour token does not exist.</para>
              <para role="param">env:Sender - ter:InvalidArgVal - ter:SpaceNotSupported</para>
              <para role="text">A space is referenced which is not supported by the PTZ node.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>access class</term>
            <listitem>
              <para role="access">ACTUATE</para>
            </listitem>
          </varlistentry>
        </variablelist>
      </section>
      <section>
        <title>OperatePresetTour</title>
        <para>A device supporting preset tours shall allow starting, stopping, or pausing a preset tour through OperatePresetTour.</para>
        <para>Preset tour can be operated with the PresetTourOperation parameter of OperatePresetTour command. </para>
        <itemizedlist>
          <listitem>
            <para>Start: indicates starting the preset tour or re-starting the paused preset tour. </para>
          </listitem>
          <listitem>
            <para>Stop: indicates stopping the preset tour.</para>
          </listitem>
          <listitem>
            <para>Pause:iIndicates pausing the preset tour.</para>
          </listitem>
        </itemizedlist>
        <para>When receiving another OperatePresetTour command of Start operation for a preset tour which has already been started, the preset tour shall be restarted with the newly requested parameter.</para>
        <variablelist role="op">
          <varlistentry>
            <term>request</term>
            <listitem>
              <para role="param">ProfileToken [tt:ReferenceToken]</para>
              <para role="text">Reference to an existing media profile.</para>
              <para role="param">PresetTourToken [tt:PTZPresetTourToken]</para>
              <para role="text">Reference to an existing preset tour.</para>
              <para role="param">Operation [tt:PTZPresetTourOperation]</para>
              <para role="text">Operation information.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>response</term>
            <listitem>
              <para role="text">This is an empty message.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>faults</term>
            <listitem>
              <para role="param">env:Sender - ter:InvalidArgVal - ter:NoProfile</para>
              <para role="text">The requested profile token does not exist.</para>
              <para role="param">env:Sender - ter:InvalidArgVal - ter:NoPTZProfile</para>
              <para role="text">The requested profile token does not reference a PTZ configuration.</para>
              <para role="param">env:Sender - ter:InvalidArgVal - ter:NoToken</para>
              <para role="text">The requested preset tour token does not exist.</para>
              <para role="param">env:Sender - ter:InvalidArgVal - ter:<phrase>InvalidPresetTour</phrase></para>
              <para role="text">The requested PresetTour includes invalid parameter(s).</para>
              <para role="param">env:Receiver - ter:InvalidArgVal - ter:ActivationFailed</para>
              <para role="text">The requested preset tour cannot be activated while PTZ unit is moving or another preset tour is now activated.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>access class</term>
            <listitem>
              <para role="access">ACTUATE</para>
            </listitem>
          </varlistentry>
        </variablelist>
      </section>
      <section>
        <title>RemovePresetTour</title>
        <para>A device supporting preset tours shall support removing preset tours through RemoevPresetTour.</para>
        <variablelist role="op">
          <varlistentry>
            <term>request</term>
            <listitem>
              <para role="param">ProfileToken [tt:ReferenceToken]</para>
              <para role="text">Reference to an existing media profile.</para>
              <para role="param">PresetTourToken [tt:PTZPresetTourToken]</para>
              <para role="text">Reference to an existing preset tour.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>response</term>
            <listitem>
              <para role="text">This is an empty message.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>faults</term>
            <listitem>
              <para role="param">env:Sender - ter:InvalidArgVal - ter:NoProfile</para>
              <para role="text">The requested profile token ProfileToken does not exist.</para>
              <para role="param">env:Sender - ter:InvalidArgVal - ter:NoPTZProfile</para>
              <para role="text">The requested profile token does not reference a PTZ configuration.</para>
              <para role="param">env:Sender - ter:InvalidArgVal - ter:NoToken</para>
              <para role="text">The requested preset tour token does not exist.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>access class</term>
            <listitem>
              <para role="access">ACTUATE</para>
            </listitem>
          </varlistentry>
        </variablelist>
      </section>
      <section>
        <title>Preset tour parameters</title>
        <para>A preset tour is composed of following parameters:</para>
        <para>
          <emphasis role="bold">PresetTour</emphasis>: Configuration of a preset tour.</para>
        <itemizedlist>
          <listitem>
            <para>Name: Name of the preset tour [Optional]</para>
          </listitem>
          <listitem>
            <para>Status: Indicates the current status of the preset tour. This parameter in the argument of the ModifyPresetTour command shall be ignored.</para>
            <itemizedlist>
              <listitem>
                <para>Idle: Preset tour is not activated.</para>
              </listitem>
              <listitem>
                <para>Touring: Preset tour is activated and now under touring.</para>
              </listitem>
              <listitem>
                <para>Paused: Preset tour is under pause at the middle of the tour by client. This status requires Start operation from a client to re-start.</para>
              </listitem>
            </itemizedlist>
          </listitem>
          <listitem>
            <para>AutoStart: Flag to enable the preset tour activated always. When this flag is set to True in a preset tour, the device shall set the flags of all other preset tours referring to the same PTZNode to False, so that only one tour on the device is marked as AutoStart. Starting and stopping the preset tour by OperatePresetTour shall change this flag to False. Pausing and resuming the preset tour by OperatePresetTour shall not change this flag.</para>
          </listitem>
          <listitem>
            <para>TourSpot: Presets with its configuration for touring [Optional]</para>
            <itemizedlist>
              <listitem>
                <para>PresetDetail: Detail configuration of the preset for the tour spot. One out of the three options below shall be chosen.</para>
                <itemizedlist>
                  <listitem>
                    <para>PresetToken: Specifies an existing PresetToken as this tour spot.</para>
                  </listitem>
                  <listitem>
                    <para>Home: Specifies the home position as the tour spot. Only “True” to this Boolean parameter shall be valid. “False” shall be treated as an error due to an invalid argument.</para>
                  </listitem>
                  <listitem>
                    <para>PTZPosition: Specifies the vector of PTZ node as the tour spot</para>
                  </listitem>
                </itemizedlist>
              </listitem>
              <listitem>
                <para>Speed: PTZ speed moving to this tour spot. [Optional] </para>
              </listitem>
              <listitem>
                <para>StayTime: Time duration of stay on the spot. [Optional]</para>
              </listitem>
            </itemizedlist>
          </listitem>
          <listitem>
            <para>PresetTourStartingCondition: Configuration of the starting preset tour. </para>
            <itemizedlist>
              <listitem>
                <para>RecurringTime: Parameter to specify how many times the preset tour is recurred. [Optional]</para>
              </listitem>
              <listitem>
                <para>RecurringDuration: Parameter to specify how long duration time the preset tour is recurred [Optional]</para>
                <itemizedlist>
                  <listitem>
                    <para>If both conditions RecurringTime and RecurringDuration are configured, the preset tour shall finish with one of the conditions satisfied earlier. If both are omitted, PresetTour shall be recurred without limitation.</para>
                  </listitem>
                </itemizedlist>
              </listitem>
              <listitem>
                <para>PresetTourDirection: A device refers this flag to choose which direction the preset tour goes. It is omissible parameter and Forward shall be chosen in case it is omitted. [Optional] </para>
                <itemizedlist>
                  <listitem>
                    <para>Forward: Preset tour goes in forward order.</para>
                  </listitem>
                  <listitem>
                    <para>Backward: Preset tour goes in backward order.</para>
                  </listitem>
                </itemizedlist>
              </listitem>
            </itemizedlist>
          </listitem>
          <listitem>
            <para>Token: Unique identifier of the preset tour</para>
          </listitem>
        </itemizedlist>
      </section>
    </section>
    <section>
      <title>Pan/tilt control direction configuration</title>
      <para>Pan/tilt control direction configuration is one set of parameters in PTZ configuration used to configure the movement directions of pan and tilt in the two following ways:</para>
      <orderedlist>
        <listitem>
          <para>E-Flip</para>
        </listitem>
      </orderedlist>
      <para>E-Flip is flipping of the control directions of pan/tilt when the lens passes the nadir or the zenith direction during a tilt movement. This functionality is useful when controlling domes using a human joystick control, where a client can track an object that passes the nadir and doesn’t have to bother about inverted controls.</para>
      <orderedlist continuation="continues">
        <listitem>
          <para>Reverse</para>
        </listitem>
      </orderedlist>
      <para>The Reverse parameter is for switching the positive and negative positions of the pan/tilt control direction. This feature can be used to configure appropriate control direction of pan/tilt based on directions that the device is mounted, for example, in the ceiling downwards or on the surface upwards.</para>
      <para>
        <xref linkend="_Ref298916952" /> to <xref linkend="_Ref298916952d" /> show an example how the control directions of pan/tilt are changed by E-Flip feature and Reverse feature. </para>
      <figure  xml:id="_Ref298916952">
        <title>Normal pan/tilt control direction</title>
        <mediaobject>
          <imageobject>
            <imagedata fileref="media/Ptz/image5.svg" contentwidth="151.77mm" contentdepth="64.52mm" />
          </imageobject>
        </mediaobject>
      </figure>
      <figure>
        <title>Normal pan/tilt control direction with E-Flip activated</title>
        <mediaobject>
          <imageobject>
            <imagedata fileref="media/Ptz/image6.svg" contentwidth="151.77mm" contentdepth="64.52mm" />
          </imageobject>
        </mediaobject>
      </figure>
      <figure>
        <title>Reversed pan/tilt control direction</title>
        <mediaobject>
          <imageobject>
            <imagedata fileref="media/Ptz/image7.svg" contentwidth="151.77mm" contentdepth="59.23mm" />
          </imageobject>
        </mediaobject>
      </figure>
      <figure  xml:id="_Ref298916952d">
        <title>Reversed pan/tilt control direction with E-Flip activated</title>
        <mediaobject>
          <imageobject>
            <imagedata fileref="media/Ptz/image8.svg" contentwidth="151.77mm" contentdepth="59.23mm" />
          </imageobject>
        </mediaobject>
      </figure>
      <para>If the control direction of pan/tilt is changed, it is recommended to adapt the orientation of the video image via the Rotation parameter of VideoSourceConfiguration to align pan/tilt and video.</para>
    </section>
    <section>
      <title>GetServiceCapabilities</title>
      <para>The capabilities reflect optional functions and functionality of a service. The information is static and does not change during device operation. The following capabilites are available:</para>
      <variablelist>
        <varlistentry>
          <term>EFlip</term>
          <listitem><para>Indicates whether or not E-Flip is supported.</para></listitem>
        </varlistentry>
        <varlistentry>
          <term>Reverse</term>
          <listitem><para>Indicates whether or not reversing of pan/tilt control direction is supported.</para></listitem>
        </varlistentry>
        <varlistentry>
          <term>GetCompatibleConfigurations</term>
          <listitem><para>Indicates the support for GetCompatibleConfigurations command.</para></listitem>
        </varlistentry>
        <varlistentry>
          <term>MoveStatus</term>
          <listitem><para>Indicates that the PTZStatus includes MoveStatus information.</para></listitem>
        </varlistentry>
        <varlistentry>
          <term>StatusPosition</term>
          <listitem><para>Indicates that the PTZStatus includes Position information.</para></listitem>
        </varlistentry>
        <varlistentry>
          <term>MoveAndTrack</term>
          <listitem><para>Indicates level of support for MoveAndStartTracking. Options are PresetToken, GeoLocation, PTZVector and ObjectID.</para></listitem>
        </varlistentry>
      </variablelist>
      <variablelist role="op">
        <varlistentry>
          <term>request</term>
          <listitem>
            <para role="text">This is an empty message.</para>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term>response</term>
          <listitem>
            <para role="param">Capabilities  [tptz:Capabilities]</para>
            <para role="text">List of the above defined capabilities.</para>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term>faults</term>
          <listitem>
            <para role="text">None</para>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term>access class</term>
          <listitem>
            <para role="access">PRE_AUTH</para>
          </listitem>
        </varlistentry>
      </variablelist>
    </section>
    <section>
      <title>Events</title>
      <para>A device supporting the PTZ service dispatches events listed in this chapter through the event service.</para>
      <section>
        <title>PTZ Presets</title>
        <para>A device supporting the PTZ service specifies handling of PTZ presets. Since the move operations are non-blocking, a client is not informed when the PTZ preset has been reached. Therefore, a device supporting the PTZ service should support the following events which inform subscribers about the status of preset movements.</para>
        <programlisting><![CDATA[Topic:
tns1:PTZController/PTZPresets/Invoked
tns1:PTZController/PTZPresets/Reached
tns1:PTZController/PTZPresets/Aborted
tns1:PTZController/PTZPresets/Left
]]></programlisting>
        <para>The typical sequence of events is that first a client requests a certain preset. When the device accepts this request, it will send out an invoked event. The invoked event has to follow either a reached event or an aborted event. The former is used when the PTZ unit was able to reach the invoked preset position, the latter in any other case. A reached event has to follow a left event, as soon as the PTZ unit moves away from the preset position.</para>
        <para>The message structure of these events is given by the following message description:</para>
        <programlisting><![CDATA[<tt:MessageDescription>
  <tt:Source>
    <tt:SimpleItemDescription Name="PTZConfigurationToken"
      Type="tt:ReferenceToken"/>
  </tt:Source>
  <tt:Data>
    <tt:SimpleItemDescription Name="PresetToken" Type="tt:ReferenceToken"/>
    <tt:SimpleItemDescription Name="PresetName"  Type="tt:Name"/>
  </tt:Data>
</tt:MessageDescription>
]]></programlisting>
      </section>
      <section>
        <title>PresetTours</title>
        <para>When a PTZ node in a device supporting the PTZ service indicates support of Preset Tour with MaximumNumberOfPresetTours greater than 0 capability value, the device shall support the following topic to inform subscribers about preset tour events. Whenever a change in Preset Tours occurs, the PTZ service shall dispatch this event:</para>
        <programlisting><![CDATA[Topic: tns1:PTZController/PTZPresetTours/Configuration
<tt:MessageDescription isProperty=True>
  <tt:Source>
    <tt:SimpleItemDescriptionName="ProfileToken" Type="tt:ReferenceToken"/>
    <tt:SimpleItemDescriptionName="PresetTourToken" Type="tt:ReferenceToken"/>
  </tt:Source>
  <tt:Data>
    <tt:SimpleItemDescriptionName="StateChange" Type="xs:boolean"/>
    <tt:ElementItemDescription Name="PresetTour" Type="tt:PTZPresetTour"/>
  </tt:Data>
</tt:MessageDescription>
]]></programlisting>
        <para>Note, the StateChange flag in the data part becomes true when the mentioned Preset Tour includes any changes of its State.</para>
      </section>
    </section>
  </chapter>
  <appendix xml:id="_additionalSpaces">
    <title>Additional PTZ Spaces (Informative)</title>
      <section>
        <title>Introduction</title>
        <para>This section lists additional spaces originally defined in a white paper. For a list of normative spaces refer to section <xref linkend="_Toc214944449" />.</para>
      </section>
    <section>
        <title>Absolute Position Spaces</title>
      <section xml:id="_Ref469302927">
        <title>Digital pan/tilt Position Space</title>
        <para>The Digital pan/tilt Position Space is suitable for Digital PTZ cameras, where the pan and tilt coordinates  represent  the  centre  point  of  a  window  positioned  on  a  sensor,  also  known  as absolute Digital PTZ. This space requires a Media Profile that includes a VideoEncoderConfiguration and a VideoSourceConfiguration [ONVIF Core Spec].</para>
        <para>The pan movement is a horizontal movement in the X direction on the sensor plane and the tilt movement is a vertical movement in the Y direction on the sensor plane. The coordinate system originates from the lower left of the sensor. <xref linkend="_Ref474431143" /> exemplifies a window located at the left upper most coordinate (0.1, 0.9) with a window size of (0.2 * plane width, 0.2 * plane height).</para>
        <figure xml:id="_Ref474431143">
          <title>Digital pan/tilt Position Space.</title>
          <mediaobject>
            <imageobject>
              <imagedata fileref="media/Ptz/image9.png" contentwidth="131.68mm" contentdepth="70.86mm" />
            </imageobject>
          </mediaobject>
        </figure>
        <para>The Digital pan/tilt Position space is defined as follows:</para>
        <programlisting><![CDATA[<tt:AbsolutePanTiltPositionSpace>
  <tt:SpaceURI>
    http://www.onvif.org/ver10/tptz/PanTiltSpaces/DigitalPositionSpace
  </tt:SpaceURI>
  <tt:XRange>
    <tt:Min>0</tt:Min>
    <tt:Max>1</tt:Max>
  </tt:XRange>
  <tt:YRange>
    <tt:Min>0</tt:Min>
    <tt:Max>1</tt:Max>
  </tt:YRange>
</tt:AbsolutePanTiltPositionSpace>
]]></programlisting>
      </section>
      <section>
        <title>Example: Positions of a window on sensor</title>
        <para>A window with VGA resolution (640x480) that is natively mapped to the same number of pixels of a cropped area on a 3MP (2048x1536) sensor, would have the pan and tilt range of:</para>
        <para><inlinemediaobject>
          <imageobject>
            <imagedata fileref="media/Ptz/image10.png" contentwidth="135.64mm" />
          </imageobject>
        </inlinemediaobject></para>
        <para>As long as the aspect ratio of the window and the sensor are identical, the same ranges for pan and tilt are expected. The device will automatically adjust the ranges based on the amount of source pixels represented in the window of interest (its width and height configured in the VideoSourceConfiguration of the requested profile).</para>
      </section>
    </section>
    <section>
      <title>Relative Translation Spaces</title>
      <section xml:id="_Ref469301263">
        <title>Spherical pan/tilt Translation Space in Degrees</title>
        <para>The Spherical pan/tilt Translation Space In Degrees derives from the Absolute Spherical pan/tilt Position Space In Degrees (see section <xref linkend="_Ref469301646" />). Instead of an absolute Position space where the reference position is fixed, the relative spherical space specifies the reference position as the cameras current position at all times. Thereby, the pan/tilt Translation is expressed as the coordinate difference from the current position to the target position. If a client wants to pan the camera by 5 degrees, it can use this relative spherical space and set the X coordinate of the direction to 5 and the Y coordinate to 0.</para>
        <para>The spherical pan/tilt translation space is defined as follows: <footnote xml:id="__FN8__"><para>The  particular  device  should  reference  the  proposed  name  space  but  the  actual  ranges  are  device  specific.  The ranges indicated in the definition shall be interpreted as the maximum and minimum range limits for the space.</para></footnote></para>
        <programlisting><![CDATA[<tt:RelativePanTiltTranslationSpace>
  <tt:SpaceURI>
    http://www.onvif.org/ver10/tptz/PanTiltSpaces/SphericalTranslation
    Space Degrees
  </tt:SpaceURI>
  <tt:XRange>
    <tt:Min>-360</tt:Min>
    <tt:Max>+360</tt:Max>
  </tt:XRange>
  <tt:YRange>
    <tt:Min>-INF</tt:Min>
    <tt:Max>+INF</tt:Max>
  </tt:YRange>
</tt:RelativePanTiltTranslationSpace>
]]></programlisting>
      </section>
      <section xml:id="_Ref469301844">
        <title>Pan/tilt Translation Space in FOV</title>
        <para>The Relative pan/tilt Translation Space in FOV is introduced to simplify the navigation with dome cameras in graphical user interfaces. When the user wants to center the camera on a certain position in the current camera view, the user requests a movement with respect to the current FOV. Due to the mechanics of a dome, the image content may rotate (see <xref linkend="_Ref469303432" />). <xref linkend="_Ref474431249" /> shows a rectangle representing the image content. The relative pan/tilt Translation Space in FOV  has  its  origin  in  the  centre  of  the  image.  The  upper  right  corner  corresponds  to  the normalized coordinate (1,1). This Space shall not be available in profiles without a VideoSourceConfiguration. The Space does not assume a certain dome model and can therefore be implemented on digital and mechanical domes.</para>
        <figure xml:id="_Ref474431249">
          <title>Relative pan/tilt Translation Space in FOV for a mechanical dome.</title>
          <mediaobject>
            <imageobject>
              <imagedata fileref="media/Ptz/transSpace.svg" contentwidth="100mm" />
            </imageobject>
          </mediaobject>
        </figure>
        <para>The proposed minimum range for this relative direction space ranges from minus infinity to plus infinity. However, a device may provide a different range. The relative direction space is defined as follows: <footnote xml:id="__FN9__"><para>The  particular  device  should  reference  the  proposed  name  space  but  the  actual  ranges  are  device  specific.  The ranges indicated in the definition sha ll be interpreted as the maximum and minimum range limits for the space.</para></footnote></para>
        <programlisting><![CDATA[<tt:RelativePanTiltTranslationSpace>
  <tt:SpaceURI>
    http://www.onvif.org/ver10/tptz/PanTiltSpaces/TranslationSpaceFov
  </tt:SpaceURI>
  <tt:XRange>
    <tt:Min>-INF</tt:Min>
    <tt:Max>+INF</tt:Max>
  </tt:XRange>
  <tt:YRange>
    <tt:Min>-INF</tt:Min>
    <tt:Max>+INF</tt:Max>
  </tt:YRange>
</tt:RelativePanTiltTranslationSpace>
]]></programlisting>
      </section>
      <section>
        <title>Digital pan/tilt Translation Space</title>
        <para>The  Digital  pan/tilt  Translation  Space  is  derived  from  the  Absolute  Digital  pan/tilt  Position Space (see section <xref linkend="_Ref469302927" />). Instead of an absolute position space where the reference position is fixed, the relative space specifies the reference position as the camera’s current position at all times. Thereby, the pan/tilt translation is expressed as the coordinate difference from the current position to the target position. If a client wants to move the window area of the Video Source Configuration by a tenth of the sensor width horizontally, it can use this relative spherical space and set the X coordinate of the direction to 0.1 and the Y coordinate to 0. This Space shall not be available in profiles without a VideoSourceConfiguration.</para>
        <para>The following <xref linkend="_Ref474431409" /> shows the space description of this Digital pan/tilt Translation coordinate system. The outer box represents the image sensor, the dotted inner box the cropped area, and the  arrow  demonstrates  a  translation  request  of  the  cropped  area  with  a  pan/tilt  vector  of (0.1,-0.2).</para>
        <figure xml:id="_Ref474431409">
          <title>Relative Digital pan/tilt Translation Space.</title>
          <mediaobject>
            <imageobject>
              <imagedata fileref="media/Ptz/digitalSpace.svg" contentwidth="100mm" />
            </imageobject>
          </mediaobject>
        </figure>
        <para>The maximum translation in positive direction for pan and tilt in this coordinate system would be represented by (1,1) the same way as the maximum negative translation would map to the coordinate (-1,-1). For example, a translation of a cropped area on a megapixel sensor from its lower  left  corner  to  its  upper  right  corner  corresponds  to  a  relative  movement  using  the translation vector (1,1) assuming that the cropped area has zero size. The Digital pan/tilt Translation Space is defined as fo llows:</para>
        <programlisting><![CDATA[<tt:RelativePanTiltTranslationSpace>
  <tt:SpaceURI>
    http://www.onvif.org/ver10/tptz/PanTiltSpaces/DigitalTranslationSpace
  </tt:SpaceURI>
  <tt:XRange>
    <tt:Min>-1</tt:Min>
    <tt:Max>+1</tt:Max>
  </tt:XRange>
  <tt:YRange>
    <tt:Min>-1</tt:Min>
    <tt:Max>+1</tt:Max>
  </tt:YRange>
</tt:RelativePanTiltTranslationSpace>
]]></programlisting>
      </section>
      <section xml:id="_Ref469303001">
        <title>Zoom Translation Space In Millimeter</title>
        <para>The Zoom Translation Space In Millimeter derives from the Absolute Zoom Position Space In Millimeter specified in section <xref linkend="_Ref469302989" /> and specifies the translation of the focal length in the camera optics. If the device supports absolute zoom movements using the Absolute Zoom Position Space In Millimeter, the maximum negative and positive translation is given by the difference of the maximum and minimum position in Millimeter.</para>
        <para>The Zoom Translation Space In Millimeter is defined as follows: <footnote xml:id="__FN10__"><para>The particular device should reference the proposed name space but the actual range is device specific. The range indicated in the definition shall be interpreted as the maximum and minimum range limits for the space.</para></footnote></para>
        <programlisting><![CDATA[<tt:RelativeZoomTranslationSpace>
  <tt:SpaceURI>
    http://www.onvif.org/ver10/tptz/ZoomSpaces/TranslationSpaceMillimeter
  </tt:SpaceURI>
  <tt:XRange>
    <tt:Min>-INF</tt:Min>
    <tt:Max>INF</tt:Max>
  </tt:XRange>
</tt:RelativeZoomTranslationSpace>
]]></programlisting>
      </section>
      <section xml:id="_Ref469303011">
        <title>Normalized digital zoom Translation Space</title>
        <para>The normalized digital zoom Translation Space derives from the Absolute normalized digital zoom Position Space specified in section <xref linkend="_Ref469302658" /> specifies the translation of the mapping between the width of a window on a sensor and the width of the full sensor. A translation change in positive direction would make the window smaller in percentage of the sensor and thereby decreasing the field of view and increasing the zoom factor. This space requires a MediaProfile that includes a VideoEncoderConfiguration and a VideoSourceConfiguration.</para>
        <para>Notice that a translation operation that uses this space will affect the width and height of the crop window that is configured in the VideoSourceConfiguration of the requested profile.</para>
        <para>The normalized digital zoom Translation Space is defined as follows: <footnote xml:id="__FN11__"><para>The particular device should reference the proposed name space but the actual range is device specific. The range indicated in the definition shall be interpreted as the maximum and minimum range limits for the space.</para></footnote></para>
        <programlisting><![CDATA[<tt:RelativeZoomTranslationSpace>
  <tt:SpaceURI>
    http://www.onvif.org/ver10/tptz/ZoomSpaces/NormalizedDigital
    TranslationSpace
  </tt:SpaceURI>
  <tt:XRange>
    <tt:Min>-INF</tt:Min>
    <tt:Max>INF</tt:Max>
  </tt:XRange>
</tt:RelativeZoomTranslationSpace>
]]></programlisting>
      </section>
    </section>
    <section>
      <title>Continuous Velocity Spaces</title>
      <section xml:id="_Ref469301599">
        <title>FOV Scaled pan/tilt Velocity Space per Second</title>
        <para>The  FOV  Scaled  pan/tilt  Velocity Space  Per  Second  is  introduced to  support  keyboard and joystick control, where the requested velocities are internally scaled by the current zoom factor of the dome. A pan/tilt vector in this space describes the move with respect to the current centre of the image. The length of this vector specifies the desired translation per second. This Space shall not be available in profiles without a VideoSourceConfiguration. The Space does not  assume a certain dome model and can therefore be implemented on digital and mechanical domes.</para>
        <para>The FOV scaled pan/tilt velocity space is defined as follows: 9</para>
        <programlisting><![CDATA[<tt:ContinuousPanTiltVelocitySpace>
  <tt:SpaceURI>
    http://www.onvif.org/ver10/tptz/PanTiltSpaces/VelocitySpaceFOV
  </tt:SpaceURI>
  <tt:XRange>
    <tt:Min>-INF</tt:Min>
    <tt:Max>INF</tt:Max>
  </tt:XRange>
  <tt:YRange>
    <tt:Min>-INF</tt:Min>
    <tt:Max>INF</tt:Max>
  </tt:YRange>
</tt:ContinuousPanTiltVelocitySpace>
]]></programlisting>
      </section>
      <section xml:id="_Ref469468775">
        <title>Zoom Velocity Space In Millimeter Per Second</title>
        <para>The Zoom Velocity Space In Millimeter Per Second derives from the Zoom Translation Space In Millimeter in section <xref linkend="_Ref469303001" /> and specifies the change per second of the focal length. The Zoom Velocity Space in Millimeter Per Second space is defined as follows: <footnote xml:id="__FN12__"><para>The particular device should reference the proposed name space but the actual range is device specific. The range indicated in the definition shall be interpreted as the maximum and minimum range limits for the space.</para></footnote></para>
        <programlisting><![CDATA[<tt:ContinuousZoomVelocitySpace>
  <tt:SpaceURI>
    http://www.onvif.org/ver10/tptz/ZoomSpaces/VelocitySpaceMillimeter
  </tt:SpaceURI>
  <tt:XRange>
    <tt:Min>-INF</tt:Min>
    <tt:Max>INF</tt:Max>
  </tt:XRange>
</tt:ContinuousZoomVelocitySpace>
]]></programlisting>
      </section>
      <section>
        <title>Normalized digital zoom Velocity Space Per Second</title>
        <para>The normalized digital zoom Velocity Space Per Second derives from the normalized digital zoom Translation Space in section <xref linkend="_Ref469303011" /> and specifies the signed change per second of the ratio between  window  width  and  sensor  width.  The  Normalized  Digital  Zoom  Ve locity  Space  Per Second is defined as follows: <footnote xml:id="__FN13__"><para>The particular device should reference the proposed name space but the actual range is device specific. The range indicated in the definition shall be interpreted as the maximum and minimum range limits for the space.</para></footnote></para>
        <programlisting><![CDATA[<tt:ContinuousZoomVelocitySpace>
  <tt:SpaceURI>
    http://www.onvif.org/ver10/tptz/ZoomSpaces/NormalizedDigitalVelocity
    Space
  </tt:SpaceURI>
  <tt:XRange>
    <tt:Min>-INF</tt:Min>
    <tt:Max>INF</tt:Max>
  </tt:XRange>
</tt:ContinuousZoomVelocitySpace>
]]></programlisting>
      </section>
    </section>
    <section>
        <title>Speed Spaces</title>
      <section>
        <title>Pan/tilt Speed Space In FOV Per Second</title>
        <para>The pan/tilt Speed Space in FOV Per  Second derives from  the Relative pan/tilt Translation Space in FOV. W hen the client requests a relative movement with a pan/tilt Speed of 0.5 FOV Per Second, the scene part which was first observed at the centre of the image will have been moved to the image border after one second. This Space shall not be available in profiles without a  VideoSourceConfiguration.  The  Space  does  not  assume  a  certain  dome  model  and  can therefore be implemented on digital and mechanical domes.</para>
        <para>The ONVIF pan/tilt speed space in FOV per second is defined as follows: <footnote xml:id="__FN14__"><para>The particular device should reference the proposed name space but the actual range is device specific. The range indicated in the definition shall be interpreted as the maximum and minimum range limits for the space.</para></footnote></para>
        <programlisting><![CDATA[<tt:PanTiltSpeedSpace>
  <tt:SpaceURI>
    http://www.onvif.org/ver10/tptz/PanTiltSpaces/SpeedSpaceFOV
  </tt:SpaceURI>
  <tt:XRange>
    <tt:Min>0.0</tt:Min>
    <tt:Max>INF</tt:Max>
  </tt:XRange>
</tt:PanTiltSpeedSpace>
]]></programlisting>
      </section>
      <section>
        <title>Normalized digital zoom Speed Space Per Second</title>
        <para>The  Normalized  Digital  Zoom  Speed  Space  Per  Second  derives  from  the  Normalized  Digital Zoom Translation Space in section <xref linkend="_Ref469303011" />and specifies the absolute change per second of the ratio between window width and sensor width. If the device supports absolute or relative zoom movements using the normalized digital zoom Position Space or the normalized digital zoom Position Space, the desired speed can be set using the normalized digital zoom Speed Space Per Second. The normalized digital zoom Speed Space Per Second is defined as follows: <footnote xml:id="__FN15__"><para>The particular device should reference the proposed name space but the actual range is device specific. The range indicated in the definition shall be interpreted as the maximum and minimum range limits for the space.</para></footnote></para>
        <programlisting><![CDATA[<tt:ZoomSpeedSpace>
  <tt:SpaceURI>
    http://www.onvif.org/ver10/tptz/ZoomSpaces/NormalizedDigitalSpeedSpace
  </tt:SpaceURI>
  <tt:XRange>
    <tt:Min>0</tt:Min>
    <tt:Max>INF</tt:Max>
  </tt:XRange>
</tt:ZoomSpeedSpace>
]]></programlisting>
      </section>
    </section>
  </appendix>
  <appendix>
    <title>GeoMove Positioning Space (Informative)</title>
      <section>
        <title>Introduction</title>
        <para>This section aims to provide a standard procedure to check if a given GeoLocated Point <inlineequation><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>L</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi></mml:mi><mml:mi></mml:mi><mml:msub><mml:mrow><mml:mi>L</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi></mml:mi><mml:mi></mml:mi><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math></inlineequation> can be seen by a GeoLocated PTZ Device <inlineequation><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>L</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi></mml:mi><mml:mi></mml:mi><mml:msub><mml:mrow><mml:mi>L</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi></mml:mi><mml:mi></mml:mi><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math></inlineequation>.</para>
        <figure>
          <title>Geo-located device pointing a geo-located target.</title>
          <mediaobject>
            <imageobject>
              <imagedata fileref="media/Ptz/image11.png" contentwidth="72.18mm" contentdepth="50.77mm" />
            </imageobject>
          </mediaobject>
        </figure>
      </section>
      <section>
        <title>Preconditions</title>
        <para>The procedure described by this annex, can be applied only if the device, that we are going to use for our Geo pointing purposes, satisfies the two assumptions described in the following subsection.</para>
      <section>
        <title>Absolute Pan Tilt Position Space</title>
        <para>In order to check if a GeoLocated point can be seen by the device, the device shall export its ranges for PAN and TILT angles using the Spherical pan/tilt Position Space in Degrees as follows:</para>
        <programlisting>&lt;tpz:GetNodeResponse&gt;
  &lt;tpz:PTZNode&gt;
    &lt;tpz:SupportedPTZSpaces&gt;
      &lt;tt:AbsolutePanTiltPositionSpace&gt;
        &lt;tt:URI&gt;…&lt;/tt:URI&gt;
        &lt;tt:XRange&gt;
          &lt;tt:Min&gt;-70&lt;/tt:Min&gt;
          &lt;tt:Max&gt;90&lt;/tt:Max&gt;
        &lt;/tt:XRange&gt;
        &lt;tt:YRange&gt;
          &lt;tt:Min&gt;-15&lt;/tt:Min&gt;
          &lt;tt:Max&gt;10&lt;/tt:Max&gt;
        &lt;/tt:YRange&gt;
      &lt;/tt:AbsolutePanTiltPositionSpace&gt;             …
    &lt;/tpz:SupportedPTZSpaces&gt;
  &lt;/tpz:PTZNode&gt;
&lt;/tpz:GetNodeResponse&gt;
        </programlisting>
        <para>In the example the device limits are:</para>
        <itemizedlist>
          <listitem>
            <para>
              <inlineequation>
                <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML">
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>m</mml:mi>
                      <mml:mi>a</mml:mi>
                      <mml:mi>x</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>p</mml:mi>
                      <mml:mi>a</mml:mi>
                      <mml:mi>n</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>=</mml:mo>
                  <mml:mn>90</mml:mn>
                  <mml:mo>°</mml:mo>
                </mml:math>
              </inlineequation>
            </para>
          </listitem>
          <listitem>
            <para>
              <inlineequation>
                <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML">
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>m</mml:mi>
                      <mml:mi>i</mml:mi>
                      <mml:mi>n</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>p</mml:mi>
                      <mml:mi>a</mml:mi>
                      <mml:mi>n</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>=</mml:mo>
                  <mml:mo>-</mml:mo>
                  <mml:mn>70</mml:mn>
                  <mml:mo>°</mml:mo>
                </mml:math>
              </inlineequation>
            </para>
          </listitem>
          <listitem>
            <para>
              <inlineequation>
                <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML">
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>m</mml:mi>
                      <mml:mi>a</mml:mi>
                      <mml:mi>x</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>t</mml:mi>
                      <mml:mi>i</mml:mi>
                      <mml:mi>l</mml:mi>
                      <mml:mi>t</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>=</mml:mo>
                  <mml:mn>10</mml:mn>
                  <mml:mo>°</mml:mo>
                </mml:math>
              </inlineequation>
            </para>
          </listitem>
          <listitem>
            <para>
              <inlineequation>
                <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML">
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>m</mml:mi>
                      <mml:mi>i</mml:mi>
                      <mml:mi>n</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>t</mml:mi>
                      <mml:mi>i</mml:mi>
                      <mml:mi>l</mml:mi>
                      <mml:mi>t</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>=</mml:mo>
                  <mml:mo>-</mml:mo>
                  <mml:mn>15</mml:mn>
                  <mml:mo>°</mml:mo>
                </mml:math>
              </inlineequation>
            </para>
          </listitem>
        </itemizedlist>
      </section>
      <section>
        <title>GeoOrientation </title>
        <para>In order to check if a GeoLocated point can be seen by the device, the Yaw coordinate of the device GeoOrientation <inlineequation><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>g</mml:mi><mml:mi>l</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:math></inlineequation> shall indicate the angular offset between the Geographical North <inlineequation><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>N</mml:mi><mml:mi></mml:mi></mml:math></inlineequation> and the 0° Pan position <inlineequation><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inlineequation>.</para>
        <figure>
          <title>Yaw angle convention for a geo-located PTZ device</title>
          <mediaobject>
            <imageobject>
              <imagedata fileref="media/Ptz/image12.png" contentwidth="72.18mm" contentdepth="50.77mm" />
            </imageobject>
          </mediaobject>
        </figure>
      </section>
      </section>
      <section>
        <title>Procedure</title>
        <para>Let’s consider a geo-located PTZ unit installed on a pole and a target that would like to point with the PTZ unit.</para>
        <figure>
          <title>Geo located coordinates of PTZ device and target .</title>
          <mediaobject>
            <imageobject>
              <imagedata fileref="media/Ptz/image11.png" contentwidth="72.18mm" contentdepth="50.77mm" />
            </imageobject>
          </mediaobject>
        </figure>
        <para>The PTZ unit will be referenced with the geo coordinates :</para>
        <itemizedlist>
          <listitem>
            <para>
              <inlineequation>
                <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML">
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>L</mml:mi>
                      <mml:mi>a</mml:mi>
                      <mml:mi>t</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mi>
                  </mml:mi>
                </mml:math>
              </inlineequation>: the latitude value returned by the device in the GetGeoLocationResponse.</para>
          </listitem>
          <listitem>
            <para>
              <inlineequation>
                <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML">
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>L</mml:mi>
                      <mml:mi>o</mml:mi>
                      <mml:mi>n</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mi>
                  </mml:mi>
                </mml:math>
              </inlineequation>: the latitude value returned by the device in the GetGeoLocationResponse.</para>
          </listitem>
          <listitem>
            <para>
              <inlineequation>
                <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML">
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>H</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mi>
                  </mml:mi>
                </mml:math>
              </inlineequation>: the elevation value returned by the device in the GetGeoLocatonResponse.</para>
          </listitem>
        </itemizedlist>
        <para>The target will be referenced with the geo coordinates : </para>
        <itemizedlist>
          <listitem>
            <para>
              <inlineequation>
                <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML">
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>L</mml:mi>
                      <mml:mi>a</mml:mi>
                      <mml:mi>t</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mn>2</mml:mn>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mi>
                  </mml:mi>
                </mml:math>
              </inlineequation>: the latitude of the target</para>
          </listitem>
          <listitem>
            <para>
              <inlineequation>
                <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML">
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>L</mml:mi>
                      <mml:mi>o</mml:mi>
                      <mml:mi>n</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mn>2</mml:mn>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mi>
                  </mml:mi>
                </mml:math>
              </inlineequation> : the longitude of the target</para>
          </listitem>
          <listitem>
            <para>
              <inlineequation>
                <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML">
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>H</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mn>2</mml:mn>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mi>
                  </mml:mi>
                </mml:math>
              </inlineequation>: the elevation of the target </para>
          </listitem>
        </itemizedlist>
        <para>Before proceding with the calculations we need to project the two geo-located points <inlineequation><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>L</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi></mml:mi><mml:mi></mml:mi><mml:msub><mml:mrow><mml:mi>L</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math></inlineequation> and <inlineequation><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>L</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi></mml:mi><mml:mi></mml:mi><mml:msub><mml:mrow><mml:mi>L</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math></inlineequation> on a Cartesian plane<footnote xml:id="__FN16__"><para>This can be achieved by converting WGS84 coordinates to <link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://en.wikipedia.org/wiki/Universal_Transverse_Mercator_coordinate_system">Universal Transverse Mercator Coordinate System</link>.</para></footnote>. In this way we could easily apply the trigonometric functions needed to check if the angles that device should cover to point the target are within the PAN and TILT ranges of the PTZ node.</para>
        <figure>
          <title>anglepan representation.</title>
          <mediaobject>
            <imageobject>
              <imagedata fileref="media/Ptz/image13.png" contentwidth="82.50mm" contentdepth="58.17mm" />
            </imageobject>
          </mediaobject>
        </figure>
        <figure>
          <title>angletilt representation.</title>
          <mediaobject>
            <imageobject>
              <imagedata fileref="media/Ptz/image14.png" contentwidth="78.53mm" contentdepth="55.79mm" />
            </imageobject>
          </mediaobject>
        </figure>
        <para>Once we have converted the geo-located points <inlineequation><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>L</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi></mml:mi><mml:mi></mml:mi><mml:msub><mml:mrow><mml:mi>L</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math></inlineequation> and <inlineequation><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>L</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi></mml:mi><mml:mi></mml:mi><mml:msub><mml:mrow><mml:mi>L</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math></inlineequation> into Cartesian points <inlineequation><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi></mml:mi><mml:mi></mml:mi><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math></inlineequation> and <inlineequation><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi></mml:mi><mml:mi></mml:mi><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math></inlineequation> we can calcutate PAN and TILT angles at which the device should move to point the target.</para>
        <para>To calculate the PAN angle, the following formula can be used :</para>
        <informalequation>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block">
            <mml:mi>a</mml:mi>
            <mml:mi>n</mml:mi>
            <mml:mi>g</mml:mi>
            <mml:mi>l</mml:mi>
            <mml:msub>
              <mml:mrow>
                <mml:mi>e</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>p</mml:mi>
                <mml:mi>a</mml:mi>
                <mml:mi>n</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>=</mml:mo>
            <mml:mi>
            </mml:mi>
            <mml:mi>a</mml:mi>
            <mml:mi>t</mml:mi>
            <mml:mi>a</mml:mi>
            <mml:mi>n</mml:mi>
            <mml:mn>2</mml:mn>
            <mml:mi>
            </mml:mi>
            <mml:mfenced separators="|">
              <mml:mrow>
                <mml:mi>
                </mml:mi>
                <mml:mfrac>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>x</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mn>2</mml:mn>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>-</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>x</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>y</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mn>2</mml:mn>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>-</mml:mo>
                    <mml:mi>
                    </mml:mi>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>y</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                </mml:mfrac>
                <mml:mi>
                </mml:mi>
              </mml:mrow>
            </mml:mfenced>
            <mml:mo>+</mml:mo>
            <mml:mi>
            </mml:mi>
            <mml:msub>
              <mml:mrow>
                <mml:mi>γ</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>a</mml:mi>
                <mml:mi>n</mml:mi>
                <mml:mi>g</mml:mi>
                <mml:mi>l</mml:mi>
                <mml:mi>e</mml:mi>
              </mml:mrow>
            </mml:msub>
          </mml:math>
        </informalequation>
        <para>To calculate the TILT angle, the following formula can be used :</para>
        <informalequation>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block">
            <mml:mi>a</mml:mi>
            <mml:mi>n</mml:mi>
            <mml:mi>g</mml:mi>
            <mml:mi>l</mml:mi>
            <mml:msub>
              <mml:mrow>
                <mml:mi>e</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>t</mml:mi>
                <mml:mi>i</mml:mi>
                <mml:mi>l</mml:mi>
                <mml:mi>t</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>=</mml:mo>
            <mml:mi>a</mml:mi>
            <mml:mi>t</mml:mi>
            <mml:mi>a</mml:mi>
            <mml:mi>n</mml:mi>
            <mml:mn>2</mml:mn>
            <mml:mi>
            </mml:mi>
            <mml:mo>(</mml:mo>
            <mml:mi>
            </mml:mi>
            <mml:mfrac>
              <mml:mrow>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>H</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mn>2</mml:mn>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>-</mml:mo>
                <mml:mi>
                </mml:mi>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>H</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mn>1</mml:mn>
                  </mml:mrow>
                </mml:msub>
              </mml:mrow>
              <mml:mrow>
                <mml:mroot>
                  <mml:mrow>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mfenced separators="|">
                          <mml:mrow>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>x</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mn>2</mml:mn>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mo>-</mml:mo>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>x</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mn>1</mml:mn>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                        </mml:mfenced>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mn>2</mml:mn>
                      </mml:mrow>
                    </mml:msup>
                    <mml:mo>+</mml:mo>
                    <mml:mi>
                    </mml:mi>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mfenced separators="|">
                          <mml:mrow>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>y</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mn>2</mml:mn>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mo>-</mml:mo>
                            <mml:mi>
                            </mml:mi>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>y</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mn>1</mml:mn>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                        </mml:mfenced>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mn>2</mml:mn>
                      </mml:mrow>
                    </mml:msup>
                  </mml:mrow>
                  <mml:mrow />
                </mml:mroot>
              </mml:mrow>
            </mml:mfrac>
            <mml:mi>
            </mml:mi>
            <mml:mo>)</mml:mo>
          </mml:math>
        </informalequation>
        <para>Once we have both anglepan and angletilt we can compare them with PAN and TILT angles ranges to check if they can be reached by the device.</para>
        <informalequation>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block">
            <mml:msub>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>i</mml:mi>
                <mml:mi>n</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>p</mml:mi>
                <mml:mi>a</mml:mi>
                <mml:mi>n</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mi>
            </mml:mi>
            <mml:mo>≤</mml:mo>
            <mml:mi>
            </mml:mi>
            <mml:mi>a</mml:mi>
            <mml:mi>n</mml:mi>
            <mml:mi>g</mml:mi>
            <mml:mi>l</mml:mi>
            <mml:msub>
              <mml:mrow>
                <mml:mi>e</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>p</mml:mi>
                <mml:mi>a</mml:mi>
                <mml:mi>n</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mi>
            </mml:mi>
            <mml:mo>≤</mml:mo>
            <mml:mi>
            </mml:mi>
            <mml:msub>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>a</mml:mi>
                <mml:mi>x</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>p</mml:mi>
                <mml:mi>a</mml:mi>
                <mml:mi>n</mml:mi>
              </mml:mrow>
            </mml:msub>
          </mml:math>
        </informalequation>
        <informalequation>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block">
            <mml:msub>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>i</mml:mi>
                <mml:mi>n</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>t</mml:mi>
                <mml:mi>i</mml:mi>
                <mml:mi>l</mml:mi>
                <mml:mi>t</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mi>
            </mml:mi>
            <mml:mo>≤</mml:mo>
            <mml:mi>
            </mml:mi>
            <mml:mi>a</mml:mi>
            <mml:mi>n</mml:mi>
            <mml:mi>g</mml:mi>
            <mml:mi>l</mml:mi>
            <mml:msub>
              <mml:mrow>
                <mml:mi>e</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>t</mml:mi>
                <mml:mi>i</mml:mi>
                <mml:mi>l</mml:mi>
                <mml:mi>t</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mi>
            </mml:mi>
            <mml:mo>≤</mml:mo>
            <mml:mi>
            </mml:mi>
            <mml:msub>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>a</mml:mi>
                <mml:mi>x</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>t</mml:mi>
                <mml:mi>i</mml:mi>
                <mml:mi>l</mml:mi>
                <mml:mi>t</mml:mi>
              </mml:mrow>
            </mml:msub>
          </mml:math>
        </informalequation>
        <para>If both inequality are satisfied by the calcuted angles we can conclude that the target can be pointed by the device otherwise we can conclude that the target is out of the field of view of the device.</para>
      </section>
  </appendix>
  <appendix role="revhistory">
    <title>Revision History</title>
    <para />
  </appendix>
</book>
