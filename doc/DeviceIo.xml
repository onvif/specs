<?xml version="1.0"?>
<book xmlns="http://docbook.org/ns/docbook" version="5.0">
  <info>
    <title>Device IO Service Specification</title>
    <titleabbrev>Device-IO</titleabbrev>
    <releaseinfo>19.06</releaseinfo>
    <author>
      <orgname>ONVIF™</orgname>
      <uri>www.onvif.org</uri>
    </author>
    <pubdate>June, 2019</pubdate>
    <mediaobject>
      <imageobject>
        <imagedata fileref="media/logo.png" contentwidth="60mm" />
      </imageobject>
    </mediaobject>
    <copyright>
      <year>2008-2020</year>
      <holder>ONVIF™ All rights reserved.</holder>
    </copyright>
    <legalnotice>
      <para>Recipients of this document may copy, distribute, publish, or display this document so long as this copyright notice, license and disclaimer are retained with all copies of the document. No license is granted to modify this document.</para>
      <para>THIS DOCUMENT IS PROVIDED "AS IS," AND THE CORPORATION AND ITS MEMBERS AND THEIR AFFILIATES, MAKE NO REPRESENTATIONS OR WARRANTIES, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO, WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE, NON-INFRINGEMENT, OR TITLE; THAT THE CONTENTS OF THIS DOCUMENT ARE SUITABLE FOR ANY PURPOSE; OR THAT THE IMPLEMENTATION OF SUCH CONTENTS WILL NOT INFRINGE ANY PATENTS, COPYRIGHTS, TRADEMARKS OR OTHER RIGHTS.</para>
      <para>IN NO EVENT WILL THE CORPORATION OR ITS MEMBERS OR THEIR AFFILIATES BE LIABLE FOR ANY DIRECT, INDIRECT, SPECIAL, INCIDENTAL, PUNITIVE OR CONSEQUENTIAL DAMAGES, ARISING OUT OF OR RELATING TO ANY USE OR DISTRIBUTION OF THIS DOCUMENT, WHETHER OR NOT (1) THE CORPORATION, MEMBERS OR THEIR AFFILIATES HAVE BEEN ADVISED OF THE POSSIBILITY OF SUCH DAMAGES, OR (2) SUCH DAMAGES WERE REASONABLY FORESEEABLE, AND ARISING OUT OF OR RELATING TO ANY USE OR DISTRIBUTION OF THIS DOCUMENT.  THE FOREGOING DISCLAIMER AND LIMITATION ON LIABILITY DO NOT APPLY TO, INVALIDATE, OR LIMIT REPRESENTATIONS AND WARRANTIES MADE BY THE MEMBERS AND THEIR RESPECTIVE AFFILIATES TO THE CORPORATION AND OTHER MEMBERS IN CERTAIN WRITTEN POLICIES OF THE CORPORATION.</para>
    </legalnotice>
    <revhistory>
      <revision>
        <revnumber>2.1</revnumber>
        <date>Jul-2011</date>
        <author>
          <personname>Hans Busch</personname>
        </author>
        <revremark>Split from Core 2.0
Change Request 232</revremark>
      </revision>
      <revision>
        <revnumber>2.1.1</revnumber>
        <date>Jan-2012</date>
        <author>
          <personname>Hans Busch</personname>
        </author>
        <revremark>Change Requests 259, 291, 535</revremark>
      </revision>
      <revision>
        <revnumber>2.2</revnumber>
        <date>May-2012</date>
        <author>
          <personname>M.Tonomura</personname>
        </author>
        <revremark>Add serial port function</revremark>
      </revision>
      <revision>
        <revnumber>2.2.1</revnumber>
        <date>Dec-2012</date>
        <author>
          <personname>Hans Busch</personname>
        </author>
        <revremark>Change Request 708</revremark>
      </revision>
      <revision>
        <revnumber>2.4.1</revnumber>
        <date>Dec-2013</date>
        <author>
          <personname>Michio Hirai</personname>
        </author>
        <revremark>Change Request 1217</revremark>
      </revision>
      <revision>
        <revnumber>2.5</revnumber>
        <date>Dec-2014</date>
        <author>
          <personname>Michio Hirai</personname>
        </author>
        <revremark>Change Request 1492, 1516</revremark>
      </revision>
      <revision>
        <revnumber>2.6</revnumber>
        <date>Jun-2015</date>
        <author>
          <personname>Michio Hirai</personname>
        </author>
        <revremark>Change Request 1589, 1639, 1642</revremark>
      </revision>
      <revision>
        <revnumber>2.6.1</revnumber>
        <date>Aug-2015</date>
        <author>
          <personname>Tom Yui</personname>
        </author>
        <author>
          <personname>Hans Busch</personname>
        </author>
        <revremark>Add Digital Input Configuration
Change Request 1633</revremark>
      </revision>
      <revision>
        <revnumber>16.06</revnumber>
        <date>Jun-2016</date>
        <author>
          <personname>Hiroyuki Sano</personname>
        </author>
        <revremark>Change Request 1802, 1853</revremark>
      </revision>
      <revision>
        <revnumber>16.12</revnumber>
        <date>Dec-2016</date>
        <author>
          <personname>Hiroyuki Sano</personname>
        </author>
        <revremark>Change Request 1985</revremark>
      </revision>
      <revision>
        <revnumber>17.06</revnumber>
        <date>Jun-2017</date>
        <author>
          <personname>Hans Busch</personname>
        </author>
        <author>
          <personname>Hiroyuki Sano</personname>
        </author>
        <revremark>Update method layouts.
Change Request 1843, 2046
Change Request 2065</revremark>
      </revision>
      <revision>
        <revnumber>17.12</revnumber>
        <date>Dec-2017</date>
        <author>
          <personname>Hiroyuki Sano</personname>
        </author>
        <revremark>Change Request 2212, 2213</revremark>
      </revision>
      <revision>
        <revnumber>18.12</revnumber>
        <date>Dec-2018</date>
        <author>
          <personname>Hiroyuki Sano</personname>
        </author>
        <revremark>Change Request 2372</revremark>
      </revision>
      <revision>
        <revnumber>19.06</revnumber>
        <date>Jun-2019</date>
        <author>
          <personname>Hiroyuki Sano</personname>
        </author>
        <revremark>Change Request 2454</revremark>
      </revision>
    </revhistory>
  </info>
  <chapter>
    <title>Scope</title>
    <para>This document defines the web service interface for all physical inputs and outputs. For most inputs and outputs this is a pure get interface while for e.g. relays also configuration and control is include.</para>
    <para>Web service usage is outside of the scope of this document. Please refer to the ONVIF core specification.</para>
  </chapter>
  <chapter>
    <title>Normative references</title>
    <para>ONVIF Core Specification</para>
    <para role="reference">&lt;<link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://www.onvif.org/specs/core/ONVIF-Core-Specification.pdf"></link>&gt;</para>
  </chapter>
  <chapter>
    <title>Terms and Definitions</title>
    <section>
      <title>Definitions</title>
      <informaltable>
        <tgroup cols="2">
          <colspec colname="c1" colwidth="24*" />
          <colspec colname="c2" colwidth="76*" />
          <tbody valign="top">
            <row>
              <entry align="left">
                <para>
                  <emphasis role="bold">Input/Output (I/O)</emphasis>
                </para>
              </entry>
              <entry align="left">
                <para>Currently relay ports and Video/Audio Inputs/Outputs are handled.</para>
              </entry>
            </row>
          </tbody>
        </tgroup>
      </informaltable>
    </section>
  </chapter>
  <chapter>
    <title>Overview</title>
    <para>The DevideIO service offers commands to retrieve and configure the settings of physical inputs and outputs of a device. </para>
    <para>The DeviceIO service supports the configuration of the following device interfaces:</para>
    <itemizedlist>
      <listitem>
        <para>VideoOutputs</para>
      </listitem>
      <listitem>
        <para>RelayOutputs</para>
      </listitem>
      <listitem>
        <para>DigitalInputs</para>
      </listitem>
      <listitem>
        <para>Send and/or Receive serial data communication</para>
      </listitem>
    </itemizedlist>
    <para>The following commands list existing interfaces:</para>
    <itemizedlist>
      <listitem>
        <para>GetVideoOutputs – Gets all existing video outputs of the device.</para>
      </listitem>
      <listitem>
        <para>GetVideoSources – Gets all existing video sources of the device.</para>
      </listitem>
      <listitem>
        <para>GetAudioOutputs – Gets all existing audio outputs of the device.</para>
      </listitem>
      <listitem>
        <para>GetAudioSources – Gets all existing audio sources of the device</para>
      </listitem>
      <listitem>
        <para>GetRelayOutputs– Gets all existing relay outputs of the device</para>
      </listitem>
      <listitem>
        <para>GetDigitalInputs – Gets all existing digital inputs of the device</para>
      </listitem>
      <listitem>
        <para>GetSerialPorts - Gets a list of all available serial ports and their settings.</para>
      </listitem>
    </itemizedlist>
    <para>For VideoOutputs the following commands are supported:</para>
    <itemizedlist>
      <listitem>
        <para>
          <emphasis>Set&lt;device name&gt;Configuration</emphasis> – Modifies the configuration of a specific interface.</para>
      </listitem>
      <listitem>
        <para>
          <emphasis>Get&lt; device name &gt;Configuration</emphasis> – Gets the configuration of a specific interface.</para>
      </listitem>
      <listitem>
        <para>
          <emphasis>Get&lt; device name &gt;ConfigurationOptions</emphasis> – Gets the supported property values for a specific interface.</para>
      </listitem>
    </itemizedlist>
    <para>RelayOutputs supports following commands:</para>
    <itemizedlist>
      <listitem>
        <para>
          <phrase>SetRelayOutputSettings</phrase> – Modifies the configuration of a relay output</para>
      </listitem>
      <listitem>
        <para>SetRelayOutputState –  Sets the logical state</para>
      </listitem>
    </itemizedlist>
    <para>SerialPorts additionally support the following command:</para>
    <itemizedlist>
      <listitem>
        <para>Send and/or Receive serial command - Transmit/receive generic controlling data to/from a serial device</para>
      </listitem>
    </itemizedlist>
    <para>WSDL for the DeviceIO service is specified in <link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://www.onvif.org/ver10/deviceio.wsdl">http://www.onvif.org/ver10/deviceio.wsdl</link>.</para>
    <table>
      <title>Referenced namespaces (with prefix)</title>
      <tgroup cols="2">
        <colspec colname="c1" colwidth="13*" />
        <colspec colname="c2" colwidth="87*" />
        <thead>
          <row>
            <entry>
              <para>Prefix</para>
            </entry>
            <entry>
              <para>Namespace URI</para>
            </entry>
          </row>
        </thead>
        <tbody valign="top">
          <row>
            <entry>
              <para>env</para>
            </entry>
            <entry>
              <para>http://www.w3.org/2003/05/soap-envelope</para>
            </entry>
          </row>
          <row>
            <entry>
              <para>ter</para>
            </entry>
            <entry>
              <para>http://www.onvif.org/ver10/error</para>
            </entry>
          </row>
          <row>
            <entry>
              <para>xs </para>
            </entry>
            <entry>
              <para>http://www.w3.org/2001/XMLSchema </para>
            </entry>
          </row>
          <row>
            <entry>
              <para>tt</para>
            </entry>
            <entry>
              <para>http://www.onvif.org/ver10/schema</para>
            </entry>
          </row>
          <row>
            <entry>
              <para>tmd</para>
            </entry>
            <entry>
              <para>http://www.onvif.org/ver10/deviceIO/wsdl</para>
            </entry>
          </row>
        </tbody>
      </tgroup>
    </table>
  </chapter>
  <chapter>
    <title>Service</title>
    <para>This service offers commands to retrieve and configure the physical Inputs and Outputs of a device.  </para>
    <para>Commands to request the available video and audio in- and outputs are defined as well as commands to request the available relays. This service also offers functions to request and change the configuration of these entities. </para>
    <para>A device that has physical sources and outputs SHALL support this service as described in [DeviceIOService.wsdl].</para>
    <section>
      <title>VideoOutputs</title>
      <para>The VideoOutput type represents the physical Video Outputs of a device that can be connected to a monitor to display the video signal. The structure contains the Layout Settings that can be configured using the Display Service.</para>
      <section>
        <title>GetVideoOutputs</title>
        <para>This command lists all available video outputs of a device. A device that has one or more physical video outputs shall support listing of available video outputs through the GetVideoOutputs command. </para>
        <variablelist role="op">
          <varlistentry>
            <term>request</term>
            <listitem>
              <para role="text">This is an empty message.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>response</term>
            <listitem>
              <para role="param">Token - optional, unbounded [tt:ReferenceToken]</para>
              <para role="text">List of tokens enumerating all available video outputs of the device.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>faults</term>
            <listitem>
              <para role="text">None</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>access class</term>
            <listitem>
              <para role="access">READ_MEDIA</para>
            </listitem>
          </varlistentry>
        </variablelist>
      </section>
    </section>
    <section>
      <title>VideoOutputConfiguration</title>
      <section>
        <title>GetVideoOutputConfiguration</title>
        <para>This operation requests the configuration of a Video Output. A device that has one or more Video Outputs shall support the retrieval of the VideoOutputConfiguration through this command.</para>
        <variablelist role="op">
          <varlistentry>
            <term>request</term>
            <listitem>
              <para role="param">VideoOutputToken [tt:ReferenceToken]</para>
              <para role="text">Existing reference of a video output.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>response</term>
            <listitem>
              <para role="param">Configuration [tt:VideoOutputConfiguration]</para>
              <para role="text">The configuration of the video output.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>faults</term>
            <listitem>
              <para role="param">env:Sender - ter:InvalidArgVal - ter:NoVideoOutput</para>
              <para role="text">The requested Video Output does not exist.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>access class</term>
            <listitem>
              <para role="access">READ_MEDIA</para>
            </listitem>
          </varlistentry>
        </variablelist>
      </section>
      <section>
        <title>SetVideoOutputConfiguration</title>
        <para>This operation modifies a video output configuration. A device that has one or more video outputs shall support the setting of its video output configuration through this command. </para>
        <variablelist role="op">
          <varlistentry>
            <term>request</term>
            <listitem>
              <para role="param">Configuration [tt:VideoOutputConfiguration]</para>
              <para role="text">The configuration of the video output.</para>
              <para role="param">ForcePersistence [xs:boolean]</para>
              <para role="text">Deprecated modifier for temporary settings if supported by the device. </para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>response</term>
            <listitem>
              <para role="text">This is an empty message.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>faults</term>
            <listitem>
              <para role="param">env:Sender - ter:InvalidArgVal - ter:NoVideoOutput</para>
              <para role="text">The requested Video Output does not exist.</para>
              <para role="param">env:Sender - ter:InvalidArgVal - ter:<phrase>ConfigModify</phrase></para>
              <para role="text">The configuration parameters are not possible to set.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>access class</term>
            <listitem>
              <para role="access">ACTUATE</para>
            </listitem>
          </varlistentry>
        </variablelist>
      </section>
      <section>
        <title>GetVideoOutputConfigurationOptions</title>
        <para>This operation requests the VideoOutputConfigurationOptions of a VideoOutput. A device that has one or more video outputs shall support the retrieval of VideoOutputConfigurationOptions through this command.</para>
        <variablelist role="op">
          <varlistentry>
            <term>request</term>
            <listitem>
              <para role="param">VideoOutputToken [tt:ReferenceToken]</para>
              <para role="text">Existing reference of a video output.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>response</term>
            <listitem>
              <para role="param">VideoOutputOptions [tt:VideoOutputConfigurationOptions]</para>
              <para role="text">The configuration options for the video output.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>faults</term>
            <listitem>
              <para role="param">env:Sender - ter:InvalidArgVal - ter:NoVideoOutput</para>
              <para role="text">The requested Video Output does not exist.</para>
            </listitem>
          </varlistentry>
        </variablelist>
      </section>
    </section>
    <section>
      <title>VideoSources</title>
      <para>A VideoSource represents physical video input. The structure contains the pixel resolution of the video, framerate and imaging settings. The imaging settings can be manipulated through the ImagingService if supported and contains parameters for focus, exposure and brightness, for example. </para>
      <section>
        <title>GetVideoSources</title>
        <para>This operation lists all available video sources for the device. The device that has one or more video inputs shall support the listing of available video sources through the GetVideoSources command.</para>
        <variablelist role="op">
          <varlistentry>
            <term>request</term>
            <listitem>
              <para role="text">This is an empty message.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>response</term>
            <listitem>
              <para role="param">Token - optional, unbounded [tt:ReferenceToken]</para>
              <para role="text">List of tokens enumerating all available video sources of the device.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>faults</term>
            <listitem>
              <para role="text">None</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>access class</term>
            <listitem>
              <para role="access">READ_MEDIA</para>
            </listitem>
          </varlistentry>
        </variablelist>
      </section>
    </section>
    <section>
      <title>AudioOutputs</title>
      <para>The Audio Output represents the physical audio outputs that can be connected to a loudspeaker. </para>
      <section>
        <title>GetAudioOutputs</title>
        <para>This command lists all available audio outputs of a device. A device that has one or more physical audio outputs shall support listing of available audio outputs through the GetAudioOutputs command. </para>
        <variablelist role="op">
          <varlistentry>
            <term>request</term>
            <listitem>
              <para role="text">This is an empty message.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>response</term>
            <listitem>
              <para role="param">Token - optional, unbounded [tt:ReferenceToken]</para>
              <para role="text">List of tokens enumerating all available audio outputs of the device.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>faults</term>
            <listitem>
              <para role="text">None</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>access class</term>
            <listitem>
              <para role="access">READ_MEDIA</para>
            </listitem>
          </varlistentry>
        </variablelist>
      </section>
    </section>
    <section>
      <title>AudioSources</title>
      <para>An AudioSource represents unencoded audio input and states the number of input channels</para>
      <section>
        <title>GetAudioSources</title>
        <para>This operation lists all available audio sources for the device. The device that has one or more audio sources shall support the listing of available audio inputs through the GetAudioSources command.</para>
        <variablelist role="op">
          <varlistentry>
            <term>request</term>
            <listitem>
              <para role="text">This is an empty message.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>response</term>
            <listitem>
              <para role="param">Token - optional, unbounded [tt:ReferenceToken]</para>
              <para role="text">List of tokens enumerating all available audio sources of the device.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>faults</term>
            <listitem>
              <para role="text">None</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>access class</term>
            <listitem>
              <para role="access">READ_MEDIA</para>
            </listitem>
          </varlistentry>
        </variablelist>
      </section>
    </section>
    <section>
      <title>Relay Outputs</title>
      <para>The Input/Output (I/O) commands are used to control the state or observe the status of the I/O ports. If the device has I/O ports, then it shall support the I/O commands.</para>
      <para>Handling of relay outputs is also defined in DeviceManagement, see ONVIF Core Specification section Input/Output. </para>
      <section>
        <title>GetRelayOutputs</title>
        <para>This operation gets a list of all available relay outputs and their settings.</para>
        <variablelist role="op">
          <varlistentry>
            <term>request</term>
            <listitem>
              <para role="text">This is an empty message.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>response</term>
            <listitem>
              <para role="param">RelayOutputs - optional, unbounded [tt:RelayOutput]</para>
              <para role="text">List of tokens enumerating all available digital outputs of the device.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>faults</term>
            <listitem>
              <para role="text">None</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>access class</term>
            <listitem>
              <para role="access">READ_MEDIA</para>
            </listitem>
          </varlistentry>
        </variablelist>
      </section>
      <section>
        <title>GetRelayOutputOptions</title>
        <para>Request the available settings and ranges for one or all relay outputs. The method shall return the information for exactly one output when a RelayOutputToken is provided as request parameter. Otherwise the method shall return the information for all relay outputs.</para>
        <para>A device that has one or more RelayOutputs should support this command.</para>
        <para>Two examples:</para>
        <orderedlist startingnumber="2">
          <listitem>
            <para>Device supports PT1S to PT120S:</para>
            <para>&lt;tmd:RelayOutputOptions token='44'&gt;</para>
            <para>  &lt;tmd:Mode&gt;Monostable&lt;/tmd:Mode&gt;</para>
            <para>  &lt;tmd:DelayTimes&gt;1 120&lt;/tmd:DelayTimes&gt;</para>
            <para>&lt;/tmd:RelayOutputOptions&gt;</para>
          </listitem>
        </orderedlist>
        <para>2) Device supports values PT0.5S, PT1S, PT2s and PT1M:</para>
        <para>&lt;tmd:RelayOutputOptions token='123'&gt;</para>
        <para>  &lt;tmd:Mode&gt;Monostable&lt;/tmd:Mode&gt;</para>
        <para>  &lt;tmd:DelayTimes Discrete='True'&gt;0.5 1 2 60&lt;/tmd:DelayTimes&gt;</para>
        <para>&lt;/tmd:RelayOutputOptions&gt;</para>
        <variablelist role="op">
          <varlistentry>
            <term>request</term>
            <listitem>
              <para role="param">RelayOutputToken - optional [tt:ReferenceToken]</para>
              <para role="text">Optional token reference to the requested relay output.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>response</term>
            <listitem>
              <para role="param">RelayOutputOptions - optional, unbounded [tt:RelayOutputOptions]</para>
              <para role="text">List of options available for the relay outputs.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>faults</term>
            <listitem>
              <para role="text">None</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>access class</term>
            <listitem>
              <para role="access">PRE_AUTH</para>
            </listitem>
          </varlistentry>
        </variablelist>
      </section>
      <section>
        <title>SetRelayOutputSettings</title>
        <para>This operation sets the settings of a relay output.</para>
        <para>The relay can work in two relay modes:</para>
        <itemizedlist>
          <listitem>
            <para>Bistable – After setting the state, the relay remains in this state.</para>
          </listitem>
          <listitem>
            <para>Monostable – After setting the state, the relay returns to its idle state after the specified time.</para>
          </listitem>
        </itemizedlist>
        <para>The physical idle state of a relay output can be configured by setting the IdleState to ‘open’ or ‘closed’ (inversion of the relay behaviour). </para>
        <para>Idle State ‘open’ means that the relay is open when the relay state is set to ‘inactive’ through the trigger command (see Section <xref linkend="_Ref296934565" />) and closed when the state is set to ‘active’ through the same command.</para>
        <para>Idle State ‘closed’ means, that the relay is closed when the relay state is set to ‘inactive’ through the trigger command (see Section <xref linkend="_Ref296934565" />) and open when the state is set to ‘active’ through the same command.</para>
        <para>The Duration parameter of the Properties field “DelayTime” describes the time after which the relay returns to its idle state if it is in monostable mode. If the relay is set to bistable mode the value of the parameter shall be ignored.</para>
        <variablelist role="op">
          <varlistentry>
            <term>request</term>
            <listitem>
              <para role="param">RelayOutputToken [tt:ReferenceToken]</para>
              <para role="text">Token reference to the requested relay output.</para>
              <para role="param">RelayOutputSettings [tt:RelayOutputSettings]</para>
              <para role="text">The settings to be applied to the relay output.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>response</term>
            <listitem>
              <para role="text">This is an empty message.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>faults</term>
            <listitem>
              <para role="param">env:Sender - ter:InvalidArgVal - ter:RelayToken</para>
              <para role="text">Unknown relay token reference.</para>
              <para role="param">env:Sender - ter:InvalidArgVal - ter:ModeError</para>
              <para role="text">Monostable delay time not valid</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>access class</term>
            <listitem>
              <para role="access">ACTUATE</para>
            </listitem>
          </varlistentry>
        </variablelist>
      </section>
      <section xml:id="_Ref296934565">
        <title>SetRelayOutputState</title>
        <para>This operation triggers a relay output<footnote xml:id="__FN1__"><para>There is no GetRelayState command; the current logical state of the relay output is transmitted via notification and their properties.</para></footnote>.</para>
        <variablelist role="op">
          <varlistentry>
            <term>request</term>
            <listitem>
              <para role="param">RelayOutputToken [tt:ReferenceToken]</para>
              <para role="text">Token reference to the requested relay output.</para>
              <para role="param">LogicalState [tt:RelayLogicalState]</para>
              <para role="text">Trigger request, i.e., active or inactive.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>response</term>
            <listitem>
              <para role="text">This is an empty message.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>faults</term>
            <listitem>
              <para role="param">env:Sender - ter:InvalidArgVal - ter:RelayToken</para>
              <para role="text">Unknown relay token reference.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>access class</term>
            <listitem>
              <para role="access">ACTUATE</para>
            </listitem>
          </varlistentry>
        </variablelist>
      </section>
    </section>
    <section>
      <title>Digital Inputs</title>
      <para>The DigitalInput type represents the integrated physical digital inputs of a device which enable connection to external devices, such as doorbells, detectors, lights or switches (device that can be toggled between an open and closed circuit). </para>
      <section>
        <title>GetDigitalInputs</title>
        <para>This command lists all available digital inputs of a device. A device that signals support for digital inputs via its capabilities shall support listing of available inputs through the GetDigitalInputs command. A device having one or more digital inputs shall support the GetDigitalInputs command.</para>
        <variablelist role="op">
          <varlistentry>
            <term>request</term>
            <listitem>
              <para role="text">This is an empty message.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>response</term>
            <listitem>
              <para role="param">DigitalInputs - optional, unbounded [tt:DigitalInput]</para>
              <para role="text">List enumerating all available digital inputs of the device.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>faults</term>
            <listitem>
              <para role="text">None</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>access class</term>
            <listitem>
              <para role="access">READ_SYSTEM</para>
            </listitem>
          </varlistentry>
        </variablelist>
      </section>
      <section>
        <title>GetDigitalInputConfigurationOptions</title>
        <para>This operation retrieves the digital input configuration options when the digital input configuration token is known. If a specific digital input is specified, the options shall concern that particular configuration. If a token is not specified, the options shall be considered generic for the device. A device shall support the GetDigitalInputConfigurationOptions command if the device signals capability of digital input configuration via DigitalInputOptions capability.</para>
        <variablelist role="op">
          <varlistentry>
            <term>request</term>
            <listitem>
              <para role="param">Token - optional [tt:ReferenceToken]</para>
              <para role="text">Optional token reference to the requested digital input.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>response</term>
            <listitem>
              <para role="param">DigitalInputOptions - optional, unbounded [tt:DigitalInputConfigurationOptions]</para>
              <para role="text">Options available for the specified digital input.  If no token is specified, the options are applicable for all digital inputs.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>faults</term>
            <listitem>
              <para role="param">env:Sender - ter:InvalidArgVal - ter:NoConfig</para>
              <para role="text">The requested configuration indicated by Token does not exist.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>access class</term>
            <listitem>
              <para role="access">READ_SYSTEM</para>
            </listitem>
          </varlistentry>
        </variablelist>
      </section>
      <section>
        <title>SetDigitalInputConfigurations</title>
        <para>This operation modifies existing digital input configurations. When applying multiple configuration settings, the expected behaviour is to configure all or none. If one of the provided configurations is invalid, the expected behaviour of the device is to apply none of the configurations and an indication in the return fault which digital input configuration has not been accepted. A device shall support the SetDigitalInputConfigurations command if the device signals capability of digital input configuration via DigitalInputOptions capability.</para>
        <variablelist role="op">
          <varlistentry>
            <term>request</term>
            <listitem>
              <para role="param">DigitalInputs - unbounded[tt:DigitalInput]</para>
              <para role="text">the modified digital input configurations containing the unique configuration token. The digital input configuration shall exist in the device.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>response</term>
            <listitem>
              <para role="text">This is an empty message.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>faults</term>
            <listitem>
              <para role="param">env:Sender - ter:InvalidArgVal - ter:NoConfig</para>
              <para role="text">The requested configuration indicated by Token does not exist.</para>
              <para role="param">env:Sender - ter:InvalidArgVal - ter:SettingsInvalid</para>
              <para role="text">The requested settings are incorrect. Token need to be returned to indicate which digital input configuration is not acceptable.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>access class</term>
            <listitem>
              <para role="access">ACTUATE</para>
            </listitem>
          </varlistentry>
        </variablelist>
      </section>
    </section>
    <section>
      <title>SerialPorts</title>
      <para>The SerialPort type represents the physical serial port on the device and allows serial data to be read and written.</para>
      <section>
        <title>GetSerialPorts</title>
        <para>This command lists all available serial ports of a device. A device that has one or more physical serial ports shall support listing of available serial ports through the GetSerialPorts command.</para>
        <variablelist role="op">
          <varlistentry>
            <term>request</term>
            <listitem>
              <para role="text">This is an empty message.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>response</term>
            <listitem>
              <para role="param">SerialPort - optional, unbounded [tt:SerialPort]</para>
              <para role="text">list of structures describing all available serial ports of the device. If a device has no serial ports an empty list is returned</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>faults</term>
            <listitem>
              <para role="text">None</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>access class</term>
            <listitem>
              <para role="access">READ_SYSTEM</para>
            </listitem>
          </varlistentry>
        </variablelist>
      </section>
      <section>
        <title>GetSerialPortConfiguration</title>
        <para>This operation gets the configuration of a serial port.</para>
        <variablelist role="op">
          <varlistentry>
            <term>request</term>
            <listitem>
              <para role="param">SerialPortToken [tt:ReferenceToken]</para>
              <para role="text">Token reference to the requested serial port.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>response</term>
            <listitem>
              <para role="param">SerialPortConfiguration - [tmd:SerialPortConfiguration]</para>
              <para role="text">The configuration of the serial port.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>faults</term>
            <listitem>
              <para role="param">env:Sender - ter:InvalidArgVal - ter:InvalidSerialPort</para>
              <para role="text">The supplied serial port token does not exist. </para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>access class</term>
            <listitem>
              <para role="access">READ_SYSTEM</para>
            </listitem>
          </varlistentry>
        </variablelist>
      </section>
      <section>
        <title>SetSerialPortConfiguration</title>
        <para>This operation sets the setting of serial port.</para>
        <variablelist role="op">
          <varlistentry>
            <term>request</term>
            <listitem>
              <para role="param">SerialPortConfiguration [tmd:SerialPortConfiguration]</para>
              <para role="text">The desired configuration of the serial port.</para>
              <para role="param">ForcePersistence [xs:boolean]</para>
              <para role="text">Deprecated modifier for temporary settings if supported by the device. </para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>response</term>
            <listitem>
              <para role="text">This is an empty message.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>faults</term>
            <listitem>
              <para role="param">env:Sender - ter:InvalidArgVal - ter:InvalidSerialPort</para>
              <para role="text">The supplied serial port token does not exist. </para>
              <para role="param">env:Sender - ter:InvalidArgVal - ter:ConfigModify</para>
              <para role="text">The configuration parameters are not possible to set.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>access class</term>
            <listitem>
              <para role="access">ACTUATE</para>
            </listitem>
          </varlistentry>
        </variablelist>
      </section>
      <section>
        <title>GetSerialPortConfigurationOptions</title>
        <para>This operation requests the SerialPortConfigurationOptions of a SerialPort. A device that has one or more SerialPorts shall support this command.</para>
        <variablelist role="op">
          <varlistentry>
            <term>request</term>
            <listitem>
              <para role="param">SerialPortToken [tt:ReferenceToken]</para>
              <para role="text">Token reference to the requested serial port.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>response</term>
            <listitem>
              <para role="param">SerialPortConfigurationOptions [tmd:SerialPortConfigurationOptions]</para>
              <para role="text">The configuration options for the specified serial port.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>faults</term>
            <listitem>
              <para role="param">env:Sender - ter:InvalidArgVal - ter:InvalidSerialPort</para>
              <para role="text">The supplied serial port token does not exist. </para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>access class</term>
            <listitem>
              <para role="access">READ_SYSTEM</para>
            </listitem>
          </varlistentry>
        </variablelist>
      </section>
      <section>
        <title>Send ReceiveSerialCommand</title>
        <para>This section describes operations to transmit/receive <emphasis>generic</emphasis> controlling data to/from a serial device that is connected to the serial port of the device.</para>
        <para>This operation can be used for the following purposes.</para>
        <itemizedlist>
          <listitem>
            <para>Transmitting arbitrary data to the connected serial device</para>
          </listitem>
          <listitem>
            <para>Receiving data from the connected serial device</para>
          </listitem>
          <listitem>
            <para>Transmitting arbitrary data to the connected serial device and then receiving its response data</para>
          </listitem>
        </itemizedlist>
        <para>In order to make use of this command for the above purpose, this specification defines the input parameter structure as follows.</para>
        <para>A device that indicates generic serial communication service capability shall support this command.</para>
        <variablelist role="op">
          <varlistentry>
            <term>request</term>
            <listitem>
              <para role="param">Token [tt:ReferenceToken]</para>
              <para role="text">The physical serial port reference to be used when this request is invoked.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>response</term>
            <listitem>
              <para role="param">SerialData - optional [tmd:SerialData]</para>
              <para role="text">Optional received data. </para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>faults</term>
            <listitem>
              <para role="param">env:Sender - ter:InvalidArgVal - ter:InvalidSerialPort</para>
              <para role="text">The supplied serial port token does not exist. </para>
              <para role="param">env:Sender - ter:OperationProhibited - ter:DataLengthOver</para>
              <para role="text">Number of available bytes exceeded.</para>
              <para role="param">env:Sender - ter:OperationProhibited - ter:DelimiterNotSupported</para>
              <para role="text">Sequence of character (delimiter) is not supported.</para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>access class</term>
            <listitem>
              <para role="access">ACTUATE</para>
            </listitem>
          </varlistentry>
        </variablelist>
        <itemizedlist>
          <listitem>
            <para>SerialData - optional [tmd:SerialData]</para>
            <para>This element is optional to be put in the request. When transmitting serial data is needed, the request should contain the element. </para>
          </listitem>
          <listitem>
            <para>Timeout - optional [xs:duration]</para>
            <para>This element is optional to be put in the request. Depending on the specified value, it is possible for various configurations as follows.</para>
            <para>(i)	TimeOut &gt; PT0S:	Indicates that the command should be responded back within the specified period of time. In the case the device received the data which meets one of the following conditions of DataLength and Delimiter, the device should respond back with the received data instead of waiting for the specified time.</para>
            <para>(ii)	TimeOut = PT0S:	Indicates that the command should be responded back immediately (Non-blocking). It will be used in the case of only transmitting data.</para>
            <para>(iii)	TimeOut = -PT1S:	Indicates that the command should be responded after one of the following conditions (DataLength / Delimiter) is met. How long the device can hold the blocking state is vendor specific.</para>
            <para>If this element is not present in the request, the command should be responded after one of the following conditions (DataLength / Delimiter) is met. How long the device can hold the blocking state is vendor specific.</para>
          </listitem>
          <listitem>
            <para>DataLength - optional [xs:integer]</para>
            <para>This element is optional to be put in the request. This element may be put in the case that data length returned from the connected serial device is already determined as some fixed bytes length. It indicates the length of received data which can be regarded as available.</para>
          </listitem>
          <listitem>
            <para>Delimiter - optional [xs:string]</para>
            <para>This element is optional to be put in the request. This element may be put in the case that the delimiter codes returned from the connected serial device is already known. It indicates the termination data sequence of the responded data. In case the string has more than one character a device shall interpret the whole string as a single delimiter. Furthermore a device shall return  the delimiter character(s) to the client.</para>
          </listitem>
        </itemizedlist>
      </section>
    </section>
    <section>
      <title>Capabilities</title>
      <para>The capabilities reflect optional functions and functionality of a service. The information is static and does not change during device operation. </para>
      <variablelist role="op">
        <varlistentry>
          <term>request</term>
          <listitem>
            <para role="text">This is an empty message.</para>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term>response</term>
          <listitem>
            <para role="param">Capabilities [tmd:Capabilities]</para>
            <para role="text">List of capabilities as defined below.</para>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term>faults</term>
          <listitem>
            <para role="text">None</para>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term>access class</term>
          <listitem>
            <para role="access">PRE_AUTH</para>
          </listitem>
        </varlistentry>
      </variablelist>
      <para>The following capabilites are available:</para>
      <variablelist>
        <varlistentry>
          <term>VideoSources</term>
          <listitem><para>Number of video sources (defaults to none).</para></listitem>
        </varlistentry>
        <varlistentry>
          <term>VideoOutputs</term>
          <listitem><para>Number of video outputs (defaults to none).</para></listitem>
        </varlistentry>
        <varlistentry>
          <term>AudioSources</term>
          <listitem><para>Number of audio sources (defaults to none).</para></listitem>
        </varlistentry>
        <varlistentry>
          <term>AudioOutputs</term>
          <listitem><para>Number of audio outputs (defaults to none).</para></listitem>
        </varlistentry>
        <varlistentry>
          <term>RelayOutputs</term>
          <listitem><para>Number of relay outputs (defaults to none).</para></listitem>
        </varlistentry>
        <varlistentry>
          <term>DigitalInputs</term>
          <listitem><para>Number of digital inputs (defaults to none).</para></listitem>
        </varlistentry>
        <varlistentry>
          <term>SerialPorts</term>
          <listitem><para>Number of serial ports (defaults to none).</para></listitem>
        </varlistentry>
        <varlistentry>
          <term>DigitalInputOptions</term>
          <listitem><para>Indicates support for DigitalInput configuration of the idle state (defaults to false)</para></listitem>
        </varlistentry>
      </variablelist>
    </section>
    <section>
      <title>Events</title>
      <section>
        <title>DigitalInput State Change</title>
        <para>A device that signals support for digital inputs in its capabilities shall provide the following event whenever one of its input state changes:</para>
        <programlisting><![CDATA[Topic: tns1:Device/Trigger/DigitalInput
<tt:MessageDescription IsProperty="true">
  <tt:Source>
    <tt:SimpleItemDescription Name="InputToken" Type="tt:ReferenceToken"/>
  </tt:Source>
  <tt:Data>
    <tt:SimpleItemDescription Name="LogicalState" Type="xs:boolean"/>
  </tt:Data>
</tt:MessageDescription>
]]></programlisting>
        <para>If a device supports SetDigitalInputConfigurations, the Digital Input LogicalState can be either set at "true" to represent the input in the active state or set at "false" to represent the input in the idle state.</para>
        <para>If a device does not support SetDigitalInputConfigurations, the Digital Input LogicalState can be either set at "true" to represent the circuit in the closed state or set at "false" to represent the circuit in the open state.</para>
      </section>
      <section>
        <title>Relay Output Trigger</title>
        <para>A device that signals RelayOutputs in its capabilities should provide the Trigger event whenever its relay output state is changed. A device shall use the following topic and message format:</para>
        <programlisting><![CDATA[Topic: tns1:Device/Trigger/Relay
<tt:MessageDescription IsProperty="true">
  <tt:Source>
    <tt:SimpleItemDescription Name="RelayToken" Type="tt:ReferenceToken"/>
  </tt:Source>
  <tt:Data>
    <tt:SimpleItemDescription Name="LogicalState" Type="tt:RelayLogicalState"/>
  </tt:Data>
</tt:MessageDescription>
]]></programlisting>
      </section>
    </section>
  </chapter>
  <appendix>
    <title>Deprecated Interfaces</title>
    <section>
      <title>Configuration of media source and output</title>
      <para>The duplicated definition and interfaces for the handling of media source and output configuration between media service, have been deprecated with release 16.12. The following interfaces have been removed from the specification:</para>
      <itemizedlist>
        <listitem>
          <para>GetVideoSourceConfiguration</para>
        </listitem>
        <listitem>
          <para>SetVideoSourceConfiguration</para>
        </listitem>
        <listitem>
          <para>GetVideoSourceConfigurationOptions</para>
        </listitem>
        <listitem>
          <para>GetAudioOutputConfiguration</para>
        </listitem>
        <listitem>
          <para>SetAudioOutputConfiguration</para>
        </listitem>
        <listitem>
          <para>GetAudioOutputConfigurationOptions</para>
        </listitem>
        <listitem>
          <para>GetAudioSourceConfiguration</para>
        </listitem>
        <listitem>
          <para>SetAudioSourceConfiguration</para>
        </listitem>
        <listitem>
          <para>GetAudioSourceConfigurationOptions</para>
        </listitem>
      </itemizedlist>
      <para>The definitions are available via the link <link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://www.onvif.org/specs/srv/io/ONVIF-DeviceIo-Service-Spec-v1606.pdf">http://www.onvif.org/specs/srv/io/ONVIF-DeviceIo-Service-Spec-v1606.pdf</link></para>
    </section>
  </appendix>
  <appendix role="revhistory">
    <title>Revision History</title>
    <para />
  </appendix>
</book>
